
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Applying Analytical Correction to hardness of collisions for HTP &#8212; MATS 3 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/nature.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Incorporating CIA into fits" href="Incorporating%20CIA%20into%20fits.html" />
    <link rel="prev" title="Analysis of ASCENDS Line Spectra" href="Analysis%20of%20ASCENDS%20Line%20Spectra.html" />
<link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css">
  <script src="https://code.jquery.com/jquery-1.12.4.min.js" type="text/javascript"></script>
  <script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js" type="text/javascript" defer="defer"></script>


<script type="text/javascript" src="https://pages.nist.gov/leaveNotice/js/jquery.leaveNotice-nist.min.js"></script>
<script>
$(document).ready(function(){
  // Mark external (non-nist.gov) A tags with class "external"
  //If the adress start with https and ends with nist.gov
  var re_nist = new RegExp('^https?:\/\/((^\/)*\.)*nist\\.gov(\/|$)');
  //Regex to find address that start with https
  var re_absolute_address = new RegExp('^((https?:)?\/\/)');
  $("a").each(function(){
    var url=$(this).attr('href');
    if(re_nist.test(url) || !re_absolute_address.test(url)){
      $(this).addClass('local');
    }else{
      //This a href appears to be external, so tag it
      $(this).addClass('external');
    }
  });
  // Add leaveNotice to external A elements
  $('a.external').leaveNotice();
});
</script>
<link rel="stylesheet" type="text/css" href="https://pages.nist.gov/leaveNotice/css/jquery.leaveNotice.css" />


  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Incorporating%20CIA%20into%20fits.html" title="Incorporating CIA into fits"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="Analysis%20of%20ASCENDS%20Line%20Spectra.html" title="Analysis of ASCENDS Line Spectra"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">MATS 3 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="Examples.html" accesskey="U">Examples</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Applying Analytical Correction to hardness of collisions for HTP</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="applying-analytical-correction-to-hardness-of-collisions-for-htp">
<h1>Applying Analytical Correction to hardness of collisions for HTP<a class="headerlink" href="#applying-analytical-correction-to-hardness-of-collisions-for-htp" title="Permalink to this heading">¶</a></h1>
<p>Provided in the MATS v2 release are several examples highlighting MATS capabilities, which can be found in the MATS <a class="reference external" href="https://github.com/usnistgov/MATS/tree/master/Examples">examples folder</a>.</p>
<p>Dicke narrowing accounts for effective narrowing of the doppler width because of velocity changing collisions.  The magnitude of this effect is dependent on the hardness of the collisions.  Different line shapes make different assumptions on the hardness of the collision with the Nelkhin-Ghatak making the assumption that collisions are hard, meaning that the molecular velocity before a collision is forgotten after the collision, and  the Galatry profile assuming collisions are soft, meaning that many collisions are necessary to change the velocity. In reality, the hardness of the collision is related to the perturbers and absorbers being studied and acts on a continuum.  In a <a class="reference external" href="https://doi.org/10.1016/j.jqsrt.2019.106784">paper by  Konefał et al.</a> (citation below), authors map the hard Dicke Narrowing term onto the billiard ball collision model, based on a parameter beta, which is related to the pressure (parameterized as the Dicke narrowing at a pressure relative to the doppler width) and the ratio of the masses between the perturber and absorber.  As Beta can be calculated, this correction provides a more robust modeling of the Dicke Narrowing without the addition of additional floated parameters.</p>
<p><a class="reference external" href="https://doi.org/10.1016/j.jqsrt.2019.106784">M. Konefał, M. Słowiński, M. Zaborowski, R. Ciuryło, D. Lisak, P. Wcisło, Analytical-function correction to the Hartmann–Tran profile for more reliable representation of the Dicke-narrowed molecular spectra, Journal of Quantitative Spectroscopy and Radiative Transfer, Volume 242, 2020,106784,ISSN 0022-4073.</a></p>
<p><a class="reference external" href="https://github.com/usnistgov/MATS/tree/master/Examples/Beta_Parameterization">The Beta correction has been included in the MATS software and the following example provides an example of how to use it.</a></p>
<section id="simulate-spectrum-objects">
<h2>Simulate Spectrum Objects<a class="headerlink" href="#simulate-spectrum-objects" title="Permalink to this heading">¶</a></h2>
<p>Module import follows from the <a class="reference internal" href="Fitting%20Experimental%20Spectra.html#fitting-experimental-spectra"><span class="std std-ref">Fitting Experimental Spectra</span></a> and <a class="reference internal" href="Fitting%20Synthetic%20Spectra.html#fitting-synthetic-spectra"><span class="std std-ref">Fitting Synthetic Spectra</span></a> examples with additional details on how to simulate spectra found in <a class="reference internal" href="Fitting%20Synthetic%20Spectra.html#fitting-synthetic-spectra"><span class="std std-ref">Fitting Synthetic Spectra</span></a> and the source documentation.</p>
<p>After the generic parameters are introduced the line list for simulations is read in using the <a class="reference internal" href="MATS.html#MATS.linelistdata.LoadLineListData" title="MATS.linelistdata.LoadLineListData"><code class="xref py py-func docutils literal notranslate"><span class="pre">LoadLineListData()</span></code></a> function.  In this example we are making some adjustments to the line list before simulating.  In the MATS fitting, simulations are only conducted to some user-defined range outside of the spectral frequency range (wave_range = 1.5 <span class="math notranslate nohighlight">\(cm^{-1}\)</span> in the current example).  This same constraint is not imposed when simulating spectra.  This can lead to some far-wing issues between simulation and fitting if care is not taken to match the wave_range to the lines in the parameter linelist and the simulation wing_cutoff magnitude, which should also match the fit wing_cutoff magnitude. For this example, we are truncating the simulation line list to [wave_min - wave_range, wave_max + wave_range].  Additionally, values for the Dicke Narrowing air and self parameters are set and the line mixing terms are set to 0.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">MATS.linelistdata</span> <span class="kn">import</span> <span class="n">linelistdata</span>
<span class="kn">from</span> <span class="nn">MATS</span> <span class="kn">import</span> <span class="n">simulate_spectrum</span>

<span class="c1">#Generic Fit Parameters</span>
<span class="n">wave_range</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="c1">#range outside of experimental x-range to simulate</span>
<span class="n">IntensityThreshold</span> <span class="o">=</span> <span class="mf">1e-30</span> <span class="c1">#intensities must be above this value to be simulated</span>
<span class="n">Fit_Intensity</span> <span class="o">=</span> <span class="mf">1e-25</span> <span class="c1">#intensities must be above this value for the line to be fit</span>
<span class="n">order_baseline_fit</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">wave_min</span> <span class="o">=</span> <span class="mi">6326</span> <span class="c1">#cm-1</span>
<span class="n">wave_max</span> <span class="o">=</span> <span class="mi">6328</span> <span class="c1">#cm-1</span>
<span class="n">wave_space</span> <span class="o">=</span> <span class="mf">0.005</span> <span class="c1">#cm-1</span>
<span class="n">baseline_terms</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#polynomial baseline coefficients where the index is equal to the coefficient order</span>
<span class="n">etalon</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1">#Read in  linelists</span>
<span class="n">PARAM_LINELIST</span> <span class="o">=</span> <span class="n">linelistdata</span><span class="p">[</span><span class="s1">&#39;CO2_30012&#39;</span><span class="p">]</span>
<span class="c1">##Adjust the linelist before simualting spectra</span>
<span class="n">PARAM_LINELIST</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;CO2_30012.csv&#39;</span><span class="p">)</span>
<span class="n">PARAM_LINELIST</span> <span class="o">=</span> <span class="n">PARAM_LINELIST</span><span class="p">[(</span><span class="n">PARAM_LINELIST</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span><span class="o">&gt;=</span> <span class="n">wave_min</span> <span class="o">-</span> <span class="n">wave_range</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">PARAM_LINELIST</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span><span class="o">&lt;=</span> <span class="n">wave_min</span> <span class="o">+</span> <span class="n">wave_range</span><span class="p">)]</span>
<span class="n">PARAM_LINELIST</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">PARAM_LINELIST</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Fit_Intensity</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">PARAM_LINELIST</span><span class="p">[</span><span class="s1">&#39;local_iso_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">PARAM_LINELIST</span><span class="p">[</span><span class="s1">&#39;molec_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;nuVC_air&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.018596</span>
<span class="n">PARAM_LINELIST</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">PARAM_LINELIST</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Fit_Intensity</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">PARAM_LINELIST</span><span class="p">[</span><span class="s1">&#39;local_iso_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">PARAM_LINELIST</span><span class="p">[</span><span class="s1">&#39;molec_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;nuVC_self&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.01993</span>
<span class="n">PARAM_LINELIST</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">PARAM_LINELIST</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Fit_Intensity</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">PARAM_LINELIST</span><span class="p">[</span><span class="s1">&#39;local_iso_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">PARAM_LINELIST</span><span class="p">[</span><span class="s1">&#39;molec_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;y_self_296&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">PARAM_LINELIST</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">PARAM_LINELIST</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Fit_Intensity</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">PARAM_LINELIST</span><span class="p">[</span><span class="s1">&#39;local_iso_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">PARAM_LINELIST</span><span class="p">[</span><span class="s1">&#39;molec_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;y_air_296&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<p>For the purpose of showing the mechanism, we will be simulating data for <span class="math notranslate nohighlight">\(CO_{2}\)</span>, air, and 10% <span class="math notranslate nohighlight">\(CO_{2}\)</span> in air samples between 1 and 500 torr.  The structure of the script follows that outlined in the <a class="reference internal" href="Fitting%20Synthetic%20Spectra.html#fitting-synthetic-spectra"><span class="std std-ref">Fitting Synthetic Spectra</span></a> example.</p>
<p>The <a class="reference internal" href="MATS.html#MATS.spectrum.simulate_spectrum" title="MATS.spectrum.simulate_spectrum"><code class="xref py py-func docutils literal notranslate"><span class="pre">simulate_spectrum()</span></code></a> function is used to generate several spectrum class objects.  The beta_formalism variable is set to True, which simulates the spectra accounting for the change in Dicke Narrowing with the hardness of the collision.  The synthetic spectra span 3 samples: <span class="math notranslate nohighlight">\(CO_{2}\)</span>, air, and 10% <span class="math notranslate nohighlight">\(CO_{2}\)</span> in air.  The air and <span class="math notranslate nohighlight">\(CO_{2}\)</span> samples can use the diluent = ‘air’ and ‘self’ variables as the Diluent variable can be auto-generated.  However, the 10% <span class="math notranslate nohighlight">\(CO_{2}\)</span> in air sample requires the explicit definition of the Diluent variable, which is a dictionary of dictionaries where each diluent is a dictionary with composition and mass (m) keys.  This allows the calculation of the mass of perturber, which is necessary for the <span class="math notranslate nohighlight">\(\beta\)</span> implementation.  The use of the self term will generate a warning to consider switching to an explicitly name the broadener.  This warning is to have the user consider if this is causing ambiguity or unanticipated behavior.  Specifically, this could be an issue in multi-species fits or if the explict broadener and self term are both used.  To remove the use of the self broadening, have the line shape parameter file with the explicit broadener (ie. gamma0_CO2 instead of gamma0_self) and use the Diluent sample definition as modeled for the 10% <span class="math notranslate nohighlight">\(CO_{2}\)</span> in air sample (ie pure <span class="math notranslate nohighlight">\(CO_{2}\)</span> would be Diluent = {‘CO2’:{‘composition’:1, ‘m’:43.98983} }).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Synthetic Air Simulation</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Synthetic Air Samples&#39;</span><span class="p">)</span>
<span class="n">spec_1</span> <span class="o">=</span>  <span class="n">simulate_spectrum</span><span class="p">(</span><span class="n">PARAM_LINELIST</span><span class="p">,</span> <span class="n">wave_min</span><span class="p">,</span> <span class="n">wave_max</span><span class="p">,</span> <span class="n">wave_space</span><span class="p">,</span> <span class="n">wave_error</span> <span class="o">=</span> <span class="n">wave_error</span><span class="p">,</span>
                     <span class="n">SNR</span> <span class="o">=</span> <span class="n">SNR</span><span class="p">,</span> <span class="n">baseline_terms</span> <span class="o">=</span> <span class="n">baseline_terms</span><span class="p">,</span> <span class="n">temperature</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">pressure</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">diluent</span> <span class="o">=</span> <span class="s1">&#39;air&#39;</span><span class="p">,</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;Air_1_torr&#39;</span><span class="p">,</span>
                     <span class="n">wing_cutoff</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">wing_method</span> <span class="o">=</span> <span class="s1">&#39;wing_wavenumbers&#39;</span><span class="p">,</span>  <span class="n">molefraction</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span> <span class="p">:</span><span class="mi">400</span><span class="o">*</span><span class="mf">1e-6</span><span class="p">},</span>
                     <span class="n">etalons</span> <span class="o">=</span> <span class="n">etalon</span><span class="p">,</span> <span class="n">natural_abundance</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">nominal_temperature</span> <span class="o">=</span> <span class="mi">296</span><span class="p">,</span> <span class="n">IntensityThreshold</span> <span class="o">=</span> <span class="mf">1e-30</span><span class="p">,</span> <span class="n">num_segments</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">beta_formalism</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">spec_2</span> <span class="o">=</span>  <span class="n">simulate_spectrum</span><span class="p">(</span><span class="n">PARAM_LINELIST</span><span class="p">,</span> <span class="n">wave_min</span><span class="p">,</span> <span class="n">wave_max</span><span class="p">,</span> <span class="n">wave_space</span><span class="p">,</span> <span class="n">wave_error</span> <span class="o">=</span> <span class="n">wave_error</span><span class="p">,</span>
                     <span class="n">SNR</span> <span class="o">=</span> <span class="n">SNR</span><span class="p">,</span> <span class="n">baseline_terms</span> <span class="o">=</span> <span class="n">baseline_terms</span><span class="p">,</span> <span class="n">temperature</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">pressure</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">diluent</span> <span class="o">=</span> <span class="s1">&#39;air&#39;</span><span class="p">,</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;Air_10_torr&#39;</span><span class="p">,</span>
                     <span class="n">wing_cutoff</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">wing_method</span> <span class="o">=</span> <span class="s1">&#39;wing_wavenumbers&#39;</span><span class="p">,</span>  <span class="n">molefraction</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span> <span class="p">:</span><span class="mi">400</span><span class="o">*</span><span class="mf">1e-6</span><span class="p">},</span>
                     <span class="n">etalons</span> <span class="o">=</span> <span class="n">etalon</span><span class="p">,</span> <span class="n">natural_abundance</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">nominal_temperature</span> <span class="o">=</span> <span class="mi">296</span><span class="p">,</span> <span class="n">IntensityThreshold</span> <span class="o">=</span> <span class="mf">1e-30</span><span class="p">,</span> <span class="n">num_segments</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">beta_formalism</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">spec_3</span> <span class="o">=</span>  <span class="n">simulate_spectrum</span><span class="p">(</span><span class="n">PARAM_LINELIST</span><span class="p">,</span> <span class="n">wave_min</span><span class="p">,</span> <span class="n">wave_max</span><span class="p">,</span> <span class="n">wave_space</span><span class="p">,</span> <span class="n">wave_error</span> <span class="o">=</span> <span class="n">wave_error</span><span class="p">,</span>
                     <span class="n">SNR</span> <span class="o">=</span> <span class="n">SNR</span><span class="p">,</span> <span class="n">baseline_terms</span> <span class="o">=</span> <span class="n">baseline_terms</span><span class="p">,</span> <span class="n">temperature</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">pressure</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">diluent</span> <span class="o">=</span> <span class="s1">&#39;air&#39;</span><span class="p">,</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;Air_100_torr&#39;</span><span class="p">,</span>
                     <span class="n">wing_cutoff</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">wing_method</span> <span class="o">=</span> <span class="s1">&#39;wing_wavenumbers&#39;</span><span class="p">,</span> <span class="n">molefraction</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span> <span class="p">:</span><span class="mi">400</span><span class="o">*</span><span class="mf">1e-6</span><span class="p">},</span>
                     <span class="n">etalons</span> <span class="o">=</span> <span class="n">etalon</span><span class="p">,</span> <span class="n">natural_abundance</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">nominal_temperature</span> <span class="o">=</span> <span class="mi">296</span><span class="p">,</span> <span class="n">IntensityThreshold</span> <span class="o">=</span> <span class="mf">1e-30</span><span class="p">,</span> <span class="n">num_segments</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">beta_formalism</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">spec_4</span> <span class="o">=</span>  <span class="n">simulate_spectrum</span><span class="p">(</span><span class="n">PARAM_LINELIST</span><span class="p">,</span> <span class="n">wave_min</span><span class="p">,</span> <span class="n">wave_max</span><span class="p">,</span> <span class="n">wave_space</span><span class="p">,</span> <span class="n">wave_error</span> <span class="o">=</span> <span class="n">wave_error</span><span class="p">,</span>
                     <span class="n">SNR</span> <span class="o">=</span> <span class="n">SNR</span><span class="p">,</span> <span class="n">baseline_terms</span> <span class="o">=</span> <span class="n">baseline_terms</span><span class="p">,</span> <span class="n">temperature</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">pressure</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="n">diluent</span> <span class="o">=</span> <span class="s1">&#39;air&#39;</span><span class="p">,</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;Air_250_torr&#39;</span><span class="p">,</span>
                     <span class="n">wing_cutoff</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">wing_method</span> <span class="o">=</span> <span class="s1">&#39;wing_wavenumbers&#39;</span><span class="p">,</span> <span class="n">molefraction</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span> <span class="p">:</span><span class="mi">400</span><span class="o">*</span><span class="mf">1e-6</span><span class="p">},</span>
                     <span class="n">etalons</span> <span class="o">=</span> <span class="n">etalon</span><span class="p">,</span> <span class="n">natural_abundance</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">nominal_temperature</span> <span class="o">=</span> <span class="mi">296</span><span class="p">,</span> <span class="n">IntensityThreshold</span> <span class="o">=</span> <span class="mf">1e-30</span><span class="p">,</span> <span class="n">num_segments</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">beta_formalism</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">spec_5</span> <span class="o">=</span>  <span class="n">simulate_spectrum</span><span class="p">(</span><span class="n">PARAM_LINELIST</span><span class="p">,</span> <span class="n">wave_min</span><span class="p">,</span> <span class="n">wave_max</span><span class="p">,</span> <span class="n">wave_space</span><span class="p">,</span> <span class="n">wave_error</span> <span class="o">=</span> <span class="n">wave_error</span><span class="p">,</span>
                     <span class="n">SNR</span> <span class="o">=</span> <span class="n">SNR</span><span class="p">,</span> <span class="n">baseline_terms</span> <span class="o">=</span> <span class="n">baseline_terms</span><span class="p">,</span> <span class="n">temperature</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">pressure</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="n">diluent</span> <span class="o">=</span> <span class="s1">&#39;air&#39;</span><span class="p">,</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;Air_500_torr&#39;</span><span class="p">,</span>
                    <span class="n">wing_cutoff</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">wing_method</span> <span class="o">=</span> <span class="s1">&#39;wing_wavenumbers&#39;</span><span class="p">,</span>  <span class="n">molefraction</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span> <span class="p">:</span><span class="mi">400</span><span class="o">*</span><span class="mf">1e-6</span><span class="p">},</span>
                     <span class="n">etalons</span> <span class="o">=</span> <span class="n">etalon</span><span class="p">,</span> <span class="n">natural_abundance</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">nominal_temperature</span> <span class="o">=</span> <span class="mi">296</span><span class="p">,</span> <span class="n">IntensityThreshold</span> <span class="o">=</span> <span class="mf">1e-30</span><span class="p">,</span> <span class="n">num_segments</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">beta_formalism</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="c1">#Mixture of CO2 and Air</span>
<span class="c1">## Note that we had to use the Diluent method opposedc to the diluent method.  Additionally, the use of the self broadening term will generate some warnings</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Mixture Samples&#39;</span><span class="p">)</span>
<span class="n">spec_6</span> <span class="o">=</span>  <span class="n">simulate_spectrum</span><span class="p">(</span><span class="n">PARAM_LINELIST</span><span class="p">,</span> <span class="n">wave_min</span><span class="p">,</span> <span class="n">wave_max</span><span class="p">,</span> <span class="n">wave_space</span><span class="p">,</span> <span class="n">wave_error</span> <span class="o">=</span> <span class="n">wave_error</span><span class="p">,</span>
                     <span class="n">SNR</span> <span class="o">=</span> <span class="n">SNR</span><span class="p">,</span> <span class="n">baseline_terms</span> <span class="o">=</span> <span class="n">baseline_terms</span><span class="p">,</span> <span class="n">temperature</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">pressure</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;Mix_1_torr&#39;</span><span class="p">,</span>
                     <span class="n">Diluent</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;self&#39;</span><span class="p">:{</span><span class="s1">&#39;composition&#39;</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span><span class="mf">43.98983</span><span class="p">}</span> <span class="p">,</span> <span class="s1">&#39;air&#39;</span> <span class="p">:{</span><span class="s1">&#39;composition&#39;</span><span class="p">:</span><span class="mf">0.9</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span><span class="mf">28.95734</span><span class="p">}},</span>
                     <span class="n">wing_cutoff</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">wing_method</span> <span class="o">=</span> <span class="s1">&#39;wing_wavenumbers&#39;</span><span class="p">,</span>  <span class="n">molefraction</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span> <span class="p">:</span><span class="mf">0.1</span><span class="p">},</span>
                     <span class="n">etalons</span> <span class="o">=</span> <span class="n">etalon</span><span class="p">,</span> <span class="n">natural_abundance</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">nominal_temperature</span> <span class="o">=</span> <span class="mi">296</span><span class="p">,</span> <span class="n">IntensityThreshold</span> <span class="o">=</span> <span class="mf">1e-30</span><span class="p">,</span> <span class="n">num_segments</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">beta_formalism</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">spec_7</span><span class="o">=</span>  <span class="n">simulate_spectrum</span><span class="p">(</span><span class="n">PARAM_LINELIST</span><span class="p">,</span> <span class="n">wave_min</span><span class="p">,</span> <span class="n">wave_max</span><span class="p">,</span> <span class="n">wave_space</span><span class="p">,</span> <span class="n">wave_error</span> <span class="o">=</span> <span class="n">wave_error</span><span class="p">,</span>
                     <span class="n">SNR</span> <span class="o">=</span> <span class="n">SNR</span><span class="p">,</span> <span class="n">baseline_terms</span> <span class="o">=</span> <span class="n">baseline_terms</span><span class="p">,</span> <span class="n">temperature</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">pressure</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;Mix_10_torr&#39;</span><span class="p">,</span>
                     <span class="n">Diluent</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;self&#39;</span><span class="p">:{</span><span class="s1">&#39;composition&#39;</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span><span class="mf">43.98983</span><span class="p">}</span> <span class="p">,</span> <span class="s1">&#39;air&#39;</span> <span class="p">:{</span><span class="s1">&#39;composition&#39;</span><span class="p">:</span><span class="mf">0.9</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span><span class="mf">28.95734</span><span class="p">}},</span>
                     <span class="n">wing_cutoff</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">wing_method</span> <span class="o">=</span> <span class="s1">&#39;wing_wavenumbers&#39;</span><span class="p">,</span>  <span class="n">molefraction</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span> <span class="p">:</span><span class="mf">0.1</span><span class="p">},</span>
                     <span class="n">etalons</span> <span class="o">=</span> <span class="n">etalon</span><span class="p">,</span> <span class="n">natural_abundance</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">nominal_temperature</span> <span class="o">=</span> <span class="mi">296</span><span class="p">,</span> <span class="n">IntensityThreshold</span> <span class="o">=</span> <span class="mf">1e-30</span><span class="p">,</span> <span class="n">num_segments</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">beta_formalism</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">spec_8</span> <span class="o">=</span>  <span class="n">simulate_spectrum</span><span class="p">(</span><span class="n">PARAM_LINELIST</span><span class="p">,</span> <span class="n">wave_min</span><span class="p">,</span> <span class="n">wave_max</span><span class="p">,</span> <span class="n">wave_space</span><span class="p">,</span> <span class="n">wave_error</span> <span class="o">=</span> <span class="n">wave_error</span><span class="p">,</span>
                     <span class="n">SNR</span> <span class="o">=</span> <span class="n">SNR</span><span class="p">,</span> <span class="n">baseline_terms</span> <span class="o">=</span> <span class="n">baseline_terms</span><span class="p">,</span> <span class="n">temperature</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">pressure</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;Mix_100_torr&#39;</span><span class="p">,</span>
                     <span class="n">Diluent</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;self&#39;</span><span class="p">:{</span><span class="s1">&#39;composition&#39;</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span><span class="mf">43.98983</span><span class="p">}</span> <span class="p">,</span> <span class="s1">&#39;air&#39;</span> <span class="p">:{</span><span class="s1">&#39;composition&#39;</span><span class="p">:</span><span class="mf">0.9</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span><span class="mf">28.95734</span><span class="p">}},</span>
                     <span class="n">wing_cutoff</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">wing_method</span> <span class="o">=</span> <span class="s1">&#39;wing_wavenumbers&#39;</span><span class="p">,</span>  <span class="n">molefraction</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span> <span class="p">:</span><span class="mf">0.1</span><span class="p">},</span>
                     <span class="n">etalons</span> <span class="o">=</span> <span class="n">etalon</span><span class="p">,</span> <span class="n">natural_abundance</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">nominal_temperature</span> <span class="o">=</span> <span class="mi">296</span><span class="p">,</span> <span class="n">IntensityThreshold</span> <span class="o">=</span> <span class="mf">1e-30</span><span class="p">,</span> <span class="n">num_segments</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">beta_formalism</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">spec_9</span> <span class="o">=</span>  <span class="n">simulate_spectrum</span><span class="p">(</span><span class="n">PARAM_LINELIST</span><span class="p">,</span> <span class="n">wave_min</span><span class="p">,</span> <span class="n">wave_max</span><span class="p">,</span> <span class="n">wave_space</span><span class="p">,</span> <span class="n">wave_error</span> <span class="o">=</span> <span class="n">wave_error</span><span class="p">,</span>
                     <span class="n">SNR</span> <span class="o">=</span> <span class="n">SNR</span><span class="p">,</span> <span class="n">baseline_terms</span> <span class="o">=</span> <span class="n">baseline_terms</span><span class="p">,</span> <span class="n">temperature</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">pressure</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;Mix_250_torr&#39;</span><span class="p">,</span>
                     <span class="n">Diluent</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;self&#39;</span><span class="p">:{</span><span class="s1">&#39;composition&#39;</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span><span class="mf">43.98983</span><span class="p">}</span> <span class="p">,</span> <span class="s1">&#39;air&#39;</span> <span class="p">:{</span><span class="s1">&#39;composition&#39;</span><span class="p">:</span><span class="mf">0.9</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span><span class="mf">28.95734</span><span class="p">}},</span>
                     <span class="n">wing_cutoff</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">wing_method</span> <span class="o">=</span> <span class="s1">&#39;wing_wavenumbers&#39;</span><span class="p">,</span> <span class="n">molefraction</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span> <span class="p">:</span><span class="mf">0.1</span><span class="p">},</span>
                     <span class="n">etalons</span> <span class="o">=</span> <span class="n">etalon</span><span class="p">,</span> <span class="n">natural_abundance</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">nominal_temperature</span> <span class="o">=</span> <span class="mi">296</span><span class="p">,</span> <span class="n">IntensityThreshold</span> <span class="o">=</span> <span class="mf">1e-30</span><span class="p">,</span> <span class="n">num_segments</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">beta_formalism</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">spec_10</span> <span class="o">=</span>  <span class="n">simulate_spectrum</span><span class="p">(</span><span class="n">PARAM_LINELIST</span><span class="p">,</span> <span class="n">wave_min</span><span class="p">,</span> <span class="n">wave_max</span><span class="p">,</span> <span class="n">wave_space</span><span class="p">,</span> <span class="n">wave_error</span> <span class="o">=</span> <span class="n">wave_error</span><span class="p">,</span>
                     <span class="n">SNR</span> <span class="o">=</span> <span class="n">SNR</span><span class="p">,</span> <span class="n">baseline_terms</span> <span class="o">=</span> <span class="n">baseline_terms</span><span class="p">,</span> <span class="n">temperature</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">pressure</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;Mix_500_torr&#39;</span><span class="p">,</span>
                          <span class="n">Diluent</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;self&#39;</span><span class="p">:{</span><span class="s1">&#39;composition&#39;</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span><span class="mf">43.98983</span><span class="p">}</span> <span class="p">,</span> <span class="s1">&#39;air&#39;</span> <span class="p">:{</span><span class="s1">&#39;composition&#39;</span><span class="p">:</span><span class="mf">0.9</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span><span class="mf">28.95734</span><span class="p">}},</span>
                     <span class="n">wing_cutoff</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">wing_method</span> <span class="o">=</span> <span class="s1">&#39;wing_wavenumbers&#39;</span><span class="p">,</span> <span class="n">molefraction</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span> <span class="p">:</span><span class="mf">0.1</span><span class="p">},</span>
                     <span class="n">etalons</span> <span class="o">=</span> <span class="n">etalon</span><span class="p">,</span> <span class="n">natural_abundance</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">nominal_temperature</span> <span class="o">=</span> <span class="mi">296</span><span class="p">,</span> <span class="n">IntensityThreshold</span> <span class="o">=</span> <span class="mf">1e-30</span><span class="p">,</span> <span class="n">num_segments</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">beta_formalism</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1">#Pure CO2.  Notice that the use of the self broadening term will cause some warnings.</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Pure CO2 Samples&#39;</span><span class="p">)</span>
<span class="n">spec_11</span> <span class="o">=</span>  <span class="n">simulate_spectrum</span><span class="p">(</span><span class="n">PARAM_LINELIST</span><span class="p">,</span> <span class="n">wave_min</span><span class="p">,</span> <span class="n">wave_max</span><span class="p">,</span> <span class="n">wave_space</span><span class="p">,</span> <span class="n">wave_error</span> <span class="o">=</span> <span class="n">wave_error</span><span class="p">,</span>
                     <span class="n">SNR</span> <span class="o">=</span> <span class="n">SNR</span><span class="p">,</span> <span class="n">baseline_terms</span> <span class="o">=</span> <span class="n">baseline_terms</span><span class="p">,</span> <span class="n">temperature</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">pressure</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">diluent</span> <span class="o">=</span> <span class="s1">&#39;self&#39;</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;CO2_1_torr&#39;</span><span class="p">,</span>
                     <span class="n">wing_cutoff</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">wing_method</span> <span class="o">=</span> <span class="s1">&#39;wing_wavenumbers&#39;</span><span class="p">,</span>  <span class="n">molefraction</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span> <span class="p">:</span><span class="mi">1</span><span class="p">},</span>
                     <span class="n">etalons</span> <span class="o">=</span> <span class="n">etalon</span><span class="p">,</span> <span class="n">natural_abundance</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">nominal_temperature</span> <span class="o">=</span> <span class="mi">296</span><span class="p">,</span> <span class="n">IntensityThreshold</span> <span class="o">=</span> <span class="mf">1e-30</span><span class="p">,</span> <span class="n">num_segments</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">beta_formalism</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">spec_12</span> <span class="o">=</span>  <span class="n">simulate_spectrum</span><span class="p">(</span><span class="n">PARAM_LINELIST</span><span class="p">,</span> <span class="n">wave_min</span><span class="p">,</span> <span class="n">wave_max</span><span class="p">,</span> <span class="n">wave_space</span><span class="p">,</span> <span class="n">wave_error</span> <span class="o">=</span> <span class="n">wave_error</span><span class="p">,</span>
                     <span class="n">SNR</span> <span class="o">=</span> <span class="n">SNR</span><span class="p">,</span> <span class="n">baseline_terms</span> <span class="o">=</span> <span class="n">baseline_terms</span><span class="p">,</span> <span class="n">temperature</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">pressure</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">diluent</span> <span class="o">=</span> <span class="s1">&#39;self&#39;</span><span class="p">,</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;CO2_10_torr&#39;</span><span class="p">,</span>
                     <span class="n">wing_cutoff</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">wing_method</span> <span class="o">=</span> <span class="s1">&#39;wing_wavenumbers&#39;</span><span class="p">,</span>  <span class="n">molefraction</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span> <span class="p">:</span><span class="mi">1</span><span class="p">},</span>
                     <span class="n">etalons</span> <span class="o">=</span> <span class="n">etalon</span><span class="p">,</span> <span class="n">natural_abundance</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">nominal_temperature</span> <span class="o">=</span> <span class="mi">296</span><span class="p">,</span> <span class="n">IntensityThreshold</span> <span class="o">=</span> <span class="mf">1e-30</span><span class="p">,</span> <span class="n">num_segments</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">beta_formalism</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">spec_13</span> <span class="o">=</span>  <span class="n">simulate_spectrum</span><span class="p">(</span><span class="n">PARAM_LINELIST</span><span class="p">,</span> <span class="n">wave_min</span><span class="p">,</span> <span class="n">wave_max</span><span class="p">,</span> <span class="n">wave_space</span><span class="p">,</span> <span class="n">wave_error</span> <span class="o">=</span> <span class="n">wave_error</span><span class="p">,</span>
                     <span class="n">SNR</span> <span class="o">=</span> <span class="n">SNR</span><span class="p">,</span> <span class="n">baseline_terms</span> <span class="o">=</span> <span class="n">baseline_terms</span><span class="p">,</span> <span class="n">temperature</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">pressure</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">diluent</span> <span class="o">=</span> <span class="s1">&#39;self&#39;</span><span class="p">,</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;CO2_100_torr&#39;</span><span class="p">,</span>
                     <span class="n">wing_cutoff</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">wing_method</span> <span class="o">=</span> <span class="s1">&#39;wing_wavenumbers&#39;</span><span class="p">,</span>  <span class="n">molefraction</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span> <span class="p">:</span><span class="mi">1</span><span class="p">},</span>
                     <span class="n">etalons</span> <span class="o">=</span> <span class="n">etalon</span><span class="p">,</span> <span class="n">natural_abundance</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">nominal_temperature</span> <span class="o">=</span> <span class="mi">296</span><span class="p">,</span> <span class="n">IntensityThreshold</span> <span class="o">=</span> <span class="mf">1e-30</span><span class="p">,</span> <span class="n">num_segments</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">beta_formalism</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">spec_14</span> <span class="o">=</span>  <span class="n">simulate_spectrum</span><span class="p">(</span><span class="n">PARAM_LINELIST</span><span class="p">,</span> <span class="n">wave_min</span><span class="p">,</span> <span class="n">wave_max</span><span class="p">,</span> <span class="n">wave_space</span><span class="p">,</span> <span class="n">wave_error</span> <span class="o">=</span> <span class="n">wave_error</span><span class="p">,</span>
                     <span class="n">SNR</span> <span class="o">=</span> <span class="n">SNR</span><span class="p">,</span> <span class="n">baseline_terms</span> <span class="o">=</span> <span class="n">baseline_terms</span><span class="p">,</span> <span class="n">temperature</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">pressure</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>  <span class="n">diluent</span> <span class="o">=</span> <span class="s1">&#39;self&#39;</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;CO2_250_torr&#39;</span><span class="p">,</span>
                     <span class="n">wing_cutoff</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">wing_method</span> <span class="o">=</span> <span class="s1">&#39;wing_wavenumbers&#39;</span><span class="p">,</span> <span class="n">molefraction</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span> <span class="p">:</span><span class="mi">1</span><span class="p">},</span>
                     <span class="n">etalons</span> <span class="o">=</span> <span class="n">etalon</span><span class="p">,</span> <span class="n">natural_abundance</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">nominal_temperature</span> <span class="o">=</span> <span class="mi">296</span><span class="p">,</span> <span class="n">IntensityThreshold</span> <span class="o">=</span> <span class="mf">1e-30</span><span class="p">,</span> <span class="n">num_segments</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">beta_formalism</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">spec_15</span> <span class="o">=</span>  <span class="n">simulate_spectrum</span><span class="p">(</span><span class="n">PARAM_LINELIST</span><span class="p">,</span> <span class="n">wave_min</span><span class="p">,</span> <span class="n">wave_max</span><span class="p">,</span> <span class="n">wave_space</span><span class="p">,</span> <span class="n">wave_error</span> <span class="o">=</span> <span class="n">wave_error</span><span class="p">,</span>
                     <span class="n">SNR</span> <span class="o">=</span> <span class="n">SNR</span><span class="p">,</span> <span class="n">baseline_terms</span> <span class="o">=</span> <span class="n">baseline_terms</span><span class="p">,</span> <span class="n">temperature</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">pressure</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>  <span class="n">diluent</span> <span class="o">=</span> <span class="s1">&#39;self&#39;</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;CO2_500_torr&#39;</span><span class="p">,</span>
                     <span class="n">wing_cutoff</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">wing_method</span> <span class="o">=</span> <span class="s1">&#39;wing_wavenumbers&#39;</span><span class="p">,</span> <span class="n">molefraction</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span> <span class="p">:</span><span class="mi">1</span><span class="p">},</span>
                     <span class="n">etalons</span> <span class="o">=</span> <span class="n">etalon</span><span class="p">,</span> <span class="n">natural_abundance</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">nominal_temperature</span> <span class="o">=</span> <span class="mi">296</span><span class="p">,</span> <span class="n">IntensityThreshold</span> <span class="o">=</span> <span class="mf">1e-30</span><span class="p">,</span> <span class="n">num_segments</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">beta_formalism</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="generate-dataset-and-fit-parameter-files">
<h2>Generate Dataset and Fit Parameter Files<a class="headerlink" href="#generate-dataset-and-fit-parameter-files" title="Permalink to this heading">¶</a></h2>
<p>Following the procedure outlined in <a class="reference internal" href="Fitting%20Synthetic%20Spectra.html#fitting-synthetic-spectra"><span class="std std-ref">Fitting Synthetic Spectra</span></a> and <a class="reference internal" href="Fitting%20Experimental%20Spectra.html#fitting-experimental-spectra"><span class="std std-ref">Fitting Experimental Spectra</span></a>.  This example is using the SDNGP without line mixing, is constraining all parameters to multi-spectrum fits, and is floating the line center, line intensity, collisional broadening, pressure shift, speed-dependent broadening, and Dicke narrowing terms.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SPECTRA</span> <span class="o">=</span> <span class="n">MATS</span><span class="o">.</span><span class="n">Dataset</span><span class="p">([</span><span class="n">spec_1</span><span class="p">,</span> <span class="n">spec_2</span><span class="p">,</span> <span class="n">spec_3</span><span class="p">,</span> <span class="n">spec_4</span><span class="p">,</span> <span class="n">spec_5</span><span class="p">,</span> <span class="n">spec_6</span><span class="p">,</span> <span class="n">spec_7</span><span class="p">,</span> <span class="n">spec_8</span><span class="p">,</span> <span class="n">spec_9</span><span class="p">,</span> <span class="n">spec_10</span><span class="p">,</span> <span class="n">spec_11</span><span class="p">,</span> <span class="n">spec_12</span><span class="p">,</span> <span class="n">spec_13</span><span class="p">,</span> <span class="n">spec_14</span><span class="p">,</span> <span class="n">spec_15</span><span class="p">],</span> <span class="s1">&#39;CO2 Study&#39;</span><span class="p">,</span><span class="n">PARAM_LINELIST</span> <span class="p">)</span>

<span class="c1">#Generate Baseline Parameter list based on number of etalons in spectra definitions and baseline order</span>
<span class="n">BASE_LINELIST</span> <span class="o">=</span> <span class="n">SPECTRA</span><span class="o">.</span><span class="n">generate_baseline_paramlist</span><span class="p">()</span>
<span class="n">FITPARAMS</span> <span class="o">=</span> <span class="n">MATS</span><span class="o">.</span><span class="n">Generate_FitParam_File</span><span class="p">(</span><span class="n">SPECTRA</span><span class="p">,</span> <span class="n">PARAM_LINELIST</span><span class="p">,</span> <span class="n">BASE_LINELIST</span><span class="p">,</span> <span class="n">lineprofile</span> <span class="o">=</span> <span class="s1">&#39;SDNGP&#39;</span><span class="p">,</span> <span class="n">linemixing</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                               <span class="n">fit_intensity</span> <span class="o">=</span> <span class="n">Fit_Intensity</span><span class="p">,</span> <span class="n">threshold_intensity</span> <span class="o">=</span> <span class="n">IntensityThreshold</span><span class="p">,</span> <span class="n">sim_window</span> <span class="o">=</span> <span class="n">wave_range</span><span class="p">,</span>
                               <span class="n">nu_constrain</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">sw_constrain</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">gamma0_constrain</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">delta0_constrain</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                                <span class="n">aw_constrain</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">as_constrain</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                                <span class="n">nuVC_constrain</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">eta_constrain</span> <span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linemixing_constrain</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
                               <span class="c1">#additional_columns = [&#39;trans_id&#39;, &#39;local_lower_quanta&#39;, &#39;m&#39;])</span>

<span class="n">FITPARAMS</span><span class="o">.</span><span class="n">generate_fit_param_linelist_from_linelist</span><span class="p">(</span><span class="n">vary_nu</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="kc">False</span><span class="p">}},</span> <span class="n">vary_sw</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="kc">False</span><span class="p">}},</span>
                                                 <span class="n">vary_gamma0</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span> <span class="mi">1</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="kc">False</span><span class="p">}},</span> <span class="n">vary_n_gamma0</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="kc">False</span><span class="p">}},</span>
                                                 <span class="n">vary_delta0</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span> <span class="mi">1</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="kc">False</span><span class="p">}},</span> <span class="n">vary_n_delta0</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="kc">False</span><span class="p">}},</span>
                                                 <span class="n">vary_aw</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span> <span class="mi">1</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="kc">False</span><span class="p">}},</span> <span class="n">vary_n_gamma2</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="kc">False</span><span class="p">}},</span>
                                                 <span class="n">vary_as</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">vary_n_delta2</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="kc">False</span><span class="p">}},</span>
                                                 <span class="n">vary_nuVC</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="kc">True</span><span class="p">}},</span> <span class="n">vary_n_nuVC</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="kc">False</span><span class="p">}},</span>
                                                 <span class="n">vary_eta</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">vary_linemixing</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span><span class="kc">False</span><span class="p">}})</span>

<span class="n">FITPARAMS</span><span class="o">.</span><span class="n">generate_fit_baseline_linelist</span><span class="p">(</span><span class="n">vary_baseline</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">vary_molefraction</span> <span class="o">=</span> <span class="p">{</span><span class="mi">7</span><span class="p">:</span><span class="kc">False</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">Fa</span>   <span class="n">lse</span><span class="p">},</span> <span class="n">vary_xshift</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                                   <span class="n">vary_etalon_amp</span><span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">vary_etalon_period</span><span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">vary_etalon_phase</span><span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="fit-data">
<h2>Fit Data<a class="headerlink" href="#fit-data" title="Permalink to this heading">¶</a></h2>
<p>In this first iteration, we are fitting the data without including the beta_formalism to correct for the hardness of the collisions by setting the beta_formalism to False in the <a class="reference internal" href="MATS.html#MATS.fit_dataset.Fit_DataSet" title="MATS.fit_dataset.Fit_DataSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">Fit_DataSet</span></code></a>  instance, which is the default.  The results show systematic residuals at the line core based on the large range of pressures.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_data</span> <span class="o">=</span> <span class="n">MATS</span><span class="o">.</span><span class="n">Fit_DataSet</span><span class="p">(</span><span class="n">SPECTRA</span><span class="p">,</span><span class="s1">&#39;Baseline_LineList&#39;</span><span class="p">,</span> <span class="s1">&#39;Parameter_LineList&#39;</span><span class="p">,</span> <span class="n">minimum_parameter_fit_intensity</span> <span class="o">=</span> <span class="mf">1e-24</span><span class="p">,</span>
                   <span class="n">beta_formalism</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">generate_params</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">fit_data</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">wing_cutoff</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span><span class="n">wing_method</span> <span class="o">=</span> <span class="s1">&#39;wing_wavenumbers&#39;</span><span class="p">)</span>
<span class="c1">#print (result.params.pretty_print())</span>

<span class="n">fit_data</span><span class="o">.</span><span class="n">residual_analysis</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">indv_resid_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fit_data</span><span class="o">.</span><span class="n">update_params</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">param_linelist_update_file</span> <span class="o">=</span> <span class="s1">&#39;Results without Beta&#39;</span><span class="p">)</span>
<span class="n">SPECTRA</span><span class="o">.</span><span class="n">generate_summary_file</span><span class="p">(</span><span class="n">save_file</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">SPECTRA</span><span class="o">.</span><span class="n">plot_model_residuals</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/noBeta.png" src="_images/noBeta.png" />
<p>In the second iteration, the beta_formalism term is set to True.  Unsuprisingly, using the beta correction gives better results as this is how the spectra were simulated.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_data</span> <span class="o">=</span> <span class="n">MATS</span><span class="o">.</span><span class="n">Fit_DataSet</span><span class="p">(</span><span class="n">SPECTRA</span><span class="p">,</span><span class="s1">&#39;Baseline_LineList&#39;</span><span class="p">,</span> <span class="s1">&#39;Parameter_LineList&#39;</span><span class="p">,</span> <span class="n">minimum_parameter_fit_intensity</span> <span class="o">=</span> <span class="mf">1e-24</span><span class="p">,</span>
                   <span class="n">beta_formalism</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">generate_params</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">fit_data</span><span class="o">.</span><span class="n">fit_data</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">wing_cutoff</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span><span class="n">wing_method</span> <span class="o">=</span> <span class="s1">&#39;wing_wavenumbers&#39;</span><span class="p">)</span>
<span class="c1">#print (result.params.pretty_print())</span>

<span class="n">fit_data</span><span class="o">.</span><span class="n">residual_analysis</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">indv_resid_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fit_data</span><span class="o">.</span><span class="n">update_params</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="n">SPECTRA</span><span class="o">.</span><span class="n">generate_summary_file</span><span class="p">(</span><span class="n">save_file</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">SPECTRA</span><span class="o">.</span><span class="n">plot_model_residuals</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/Beta.png" src="_images/Beta.png" />
<p>The <a class="reference internal" href="MATS.html#MATS.fit_dataset.Fit_DataSet.generate_beta_output_file" title="MATS.fit_dataset.Fit_DataSet.generate_beta_output_file"><code class="xref py py-func docutils literal notranslate"><span class="pre">Fit_DataSet.generate_beta_output_file()</span></code></a> definition can be used to tabulate a value of the math:<cite>beta</cite> parameters that are used for all lines and each spectrum. By default this is saved in a file called Beta Summary File.csv.  This plot shows how this math:<cite>beta</cite>  parameter changes with sample and pressure.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fit_data</span><span class="o">.</span><span class="n">generate_beta_output_file</span><span class="p">()</span>
<span class="n">beta_summary_file</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Beta Summary File.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">beta_summary_file</span><span class="p">[</span><span class="n">beta_summary_file</span><span class="p">[</span><span class="s1">&#39;nuVC_air_vary&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">]</span>

<span class="n">pressures</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">500</span><span class="p">]</span>
<span class="n">air_beta</span> <span class="o">=</span> <span class="p">[</span><span class="n">beta_summary_file</span><span class="p">[</span><span class="n">beta_summary_file</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="mi">62</span><span class="p">][</span><span class="s1">&#39;Beta_1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">beta_summary_file</span><span class="p">[</span><span class="n">beta_summary_file</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="mi">62</span><span class="p">][</span><span class="s1">&#39;Beta_2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">beta_summary_file</span><span class="p">[</span><span class="n">beta_summary_file</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="mi">62</span><span class="p">][</span><span class="s1">&#39;Beta_3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
         <span class="n">beta_summary_file</span><span class="p">[</span><span class="n">beta_summary_file</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="mi">62</span><span class="p">][</span><span class="s1">&#39;Beta_4&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">beta_summary_file</span><span class="p">[</span><span class="n">beta_summary_file</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="mi">62</span><span class="p">][</span><span class="s1">&#39;Beta_5&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">mix_beta</span> <span class="o">=</span> <span class="p">[</span><span class="n">beta_summary_file</span><span class="p">[</span><span class="n">beta_summary_file</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="mi">62</span><span class="p">][</span><span class="s1">&#39;Beta_6&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">beta_summary_file</span><span class="p">[</span><span class="n">beta_summary_file</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="mi">62</span><span class="p">][</span><span class="s1">&#39;Beta_7&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">beta_summary_file</span><span class="p">[</span><span class="n">beta_summary_file</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="mi">62</span><span class="p">][</span><span class="s1">&#39;Beta_8&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
         <span class="n">beta_summary_file</span><span class="p">[</span><span class="n">beta_summary_file</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="mi">62</span><span class="p">][</span><span class="s1">&#39;Beta_9&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">beta_summary_file</span><span class="p">[</span><span class="n">beta_summary_file</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="mi">62</span><span class="p">][</span><span class="s1">&#39;Beta_10&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">CO2_beta</span> <span class="o">=</span> <span class="p">[</span><span class="n">beta_summary_file</span><span class="p">[</span><span class="n">beta_summary_file</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="mi">62</span><span class="p">][</span><span class="s1">&#39;Beta_11&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">beta_summary_file</span><span class="p">[</span><span class="n">beta_summary_file</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="mi">62</span><span class="p">][</span><span class="s1">&#39;Beta_12&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">beta_summary_file</span><span class="p">[</span><span class="n">beta_summary_file</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="mi">62</span><span class="p">][</span><span class="s1">&#39;Beta_13&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
         <span class="n">beta_summary_file</span><span class="p">[</span><span class="n">beta_summary_file</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="mi">62</span><span class="p">][</span><span class="s1">&#39;Beta_14&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">beta_summary_file</span><span class="p">[</span><span class="n">beta_summary_file</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="mi">62</span><span class="p">][</span><span class="s1">&#39;Beta_15&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">pressures</span><span class="p">,</span> <span class="n">air_beta</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Air&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">pressures</span><span class="p">,</span> <span class="n">mix_beta</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Mixture&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">pressures</span><span class="p">,</span> <span class="n">CO2_beta</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;CO$_</span><span class="si">{2}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pressure (Torr)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">beta$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/beta_values.png" src="_images/beta_values.png" />
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="Analysis%20of%20ASCENDS%20Line%20Spectra.html"
                          title="previous chapter">Analysis of ASCENDS Line Spectra</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="Incorporating%20CIA%20into%20fits.html"
                          title="next chapter">Incorporating CIA into fits</a></p>
  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Incorporating%20CIA%20into%20fits.html" title="Incorporating CIA into fits"
             >next</a> |</li>
        <li class="right" >
          <a href="Analysis%20of%20ASCENDS%20Line%20Spectra.html" title="Analysis of ASCENDS Line Spectra"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">MATS 3 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="Examples.html" >Examples</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Applying Analytical Correction to hardness of collisions for HTP</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>