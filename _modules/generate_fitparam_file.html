
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MATS.generate_fitparam_file &#8212; MATS 3 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/nature.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css">
  <script src="https://code.jquery.com/jquery-1.12.4.min.js" type="text/javascript"></script>
  <script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js" type="text/javascript" defer="defer"></script>


<script type="text/javascript" src="https://pages.nist.gov/leaveNotice/js/jquery.leaveNotice-nist.min.js"></script>
<script>
$(document).ready(function(){
  // Mark external (non-nist.gov) A tags with class "external"
  //If the adress start with https and ends with nist.gov
  var re_nist = new RegExp('^https?:\/\/((^\/)*\.)*nist\\.gov(\/|$)');
  //Regex to find address that start with https
  var re_absolute_address = new RegExp('^((https?:)?\/\/)');
  $("a").each(function(){
    var url=$(this).attr('href');
    if(re_nist.test(url) || !re_absolute_address.test(url)){
      $(this).addClass('local');
    }else{
      //This a href appears to be external, so tag it
      $(this).addClass('external');
    }
  });
  // Add leaveNotice to external A elements
  $('a.external').leaveNotice();
});
</script>
<link rel="stylesheet" type="text/css" href="https://pages.nist.gov/leaveNotice/css/jquery.leaveNotice.css" />


  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">MATS 3 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">MATS.generate_fitparam_file</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for MATS.generate_fitparam_file</h1><div class="highlight"><pre>
<span></span><span class="c1">#Import Packages</span>
<span class="c1"># from .Utilities import *</span>
<span class="c1">#import re</span>
<span class="kn">from</span> <span class="nn">.o2_cia_karman</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">o2_cia_karman_model</span>
<span class="p">)</span>

<div class="viewcode-block" id="Generate_FitParam_File"><a class="viewcode-back" href="../../MATS.html#MATS.generate_fitparam_file.Generate_FitParam_File">[docs]</a><span class="k">class</span> <span class="nc">Generate_FitParam_File</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class generates the parameter files used in fitting and sets up fit settings.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dataset : object</span>
<span class="sd">        Dataset object to be used in the fits</span>
<span class="sd">    param_linelist : dataframe</span>
<span class="sd">        parameter linelist dataframe name, where the dataframe has the appropriate column headers</span>
<span class="sd">    base_linelist : dataframe</span>
<span class="sd">        baseline parameter dataframe name generated from the dataset.generate_baseline_paramlist() function.</span>
<span class="sd">    CIA_linelist : dataframe, optional</span>
<span class="sd">        Future Function: CIA linelist dataframe name generated from the dataset.generate_CIA_paramlist() function.</span>
<span class="sd">    lineprofile : str</span>
<span class="sd">        lineprofile to use for the simulation. This sets values in the parameter linelist to 0 and forces them to not vary unless manually changed. Default values is VP, voigt profile. Options are VP, SDVP, NGP, SDNGP, HTP.</span>
<span class="sd">    linemixing : bool</span>
<span class="sd">        If False, then all linemixing parameters are set to 0 and not able to float.  Default is False.</span>
<span class="sd">    threshold_intensity : float</span>
<span class="sd">        This is the minimum line intensity that will be simulated. Default value is 1e-30.</span>
<span class="sd">    fit_intensity  : float</span>
<span class="sd">        This is the minimum line intensity for which parameters will be set to float. This can be overwritten manually. Default value is 1e-26.</span>
<span class="sd">    fit_window : float</span>
<span class="sd">        currently not used</span>
<span class="sd">    sim_window : float</span>
<span class="sd">        This is the region outside of the wavelength region of the dataset that will be simulated for analysis. Default value is 5 cm-1.</span>
<span class="sd">    base_linelist_savename : str</span>
<span class="sd">        filename that the baseline linelist will be saved as. Default is Baseline_LineList</span>
<span class="sd">    param_linelist_savename : str</span>
<span class="sd">        filename that the parameter linelist will be saved as. Default is Parameter_LineList.</span>
<span class="sd">    CIA_linelist_save_name : str</span>
<span class="sd">        Future Feature: filename that the CIA linelist will be saved as. Default is CIA_LineList.</span>
<span class="sd">    nu_constrain : bool</span>
<span class="sd">        True indicates that the line centers will be a global variable across all spectra. False generates a new value for each spectrum in the dataset.</span>
<span class="sd">    sw_constrain : bool</span>
<span class="sd">        True indicates that the line intensities will be a global variable across all spectra. False generates a new value for each spectrum in the dataset.</span>
<span class="sd">    gamma0_constrain : bool</span>
<span class="sd">        True indicates that the collisional width will be a global variable across all spectra. False generates a new value for each spectrum in the dataset.</span>
<span class="sd">    delta0_constrain : bool</span>
<span class="sd">        True indicates that the shift will be a global variable across all spectra. False generates a new value for each spectrum in the dataset.</span>
<span class="sd">    aw_constrain : bool</span>
<span class="sd">        True indicates that the speed dependent width will be a global variable across all spectra. False generates a new value for each spectrum in the dataset.</span>
<span class="sd">    as_constrain : bool</span>
<span class="sd">        True indicates that the speed dependent shift will be a global variable across all spectra. False generates a new value for each spectrum in the dataset.</span>
<span class="sd">    nuVC_constrain : bool</span>
<span class="sd">        True indicates that the dicke narrowing term will be a global variable across all spectra. False generates a new value for each spectrum in the dataset.</span>
<span class="sd">    eta_constrain : bool</span>
<span class="sd">        True indicates that the correlation parameter will be a global variable across all spectra. False generates a new value for each spectrum in the dataset.</span>
<span class="sd">    linemixing_constrain : bool</span>
<span class="sd">        True indicates that the first-order linemixing term will be a global variable across all spectra. False generates a new value for each spectrum in the datas</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">param_linelist</span><span class="p">,</span> <span class="n">base_linelist</span><span class="p">,</span> <span class="n">CIA_linelist</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">lineprofile</span> <span class="o">=</span> <span class="s1">&#39;VP&#39;</span><span class="p">,</span> <span class="n">linemixing</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">threshold_intensity</span> <span class="o">=</span> <span class="mf">1e-30</span><span class="p">,</span> <span class="n">fit_intensity</span> <span class="o">=</span> <span class="mf">1e-26</span><span class="p">,</span> <span class="n">fit_window</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">sim_window</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
                  <span class="n">param_linelist_savename</span> <span class="o">=</span> <span class="s1">&#39;Parameter_LineList&#39;</span><span class="p">,</span> <span class="n">base_linelist_savename</span> <span class="o">=</span> <span class="s1">&#39;Baseline_LineList&#39;</span><span class="p">,</span> <span class="n">CIA_linelist_savename</span> <span class="o">=</span> <span class="s1">&#39;CIA_LineList&#39;</span><span class="p">,</span>
                 <span class="n">nu_constrain</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">sw_constrain</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">gamma0_constrain</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">delta0_constrain</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">aw_constrain</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">as_constrain</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                 <span class="n">nuVC_constrain</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">eta_constrain</span> <span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linemixing_constrain</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                 <span class="n">additional_columns</span> <span class="o">=</span> <span class="p">[]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_linelist</span> <span class="o">=</span> <span class="n">param_linelist</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_linelist</span> <span class="o">=</span> <span class="n">base_linelist</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">CIA_model</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CIA_linelist</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CIA_linelist_savename</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CIA_linelist</span> <span class="o">=</span> <span class="n">CIA_linelist</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CIA_linelist_savename</span> <span class="o">=</span> <span class="n">CIA_linelist_savename</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lineprofile</span> <span class="o">=</span> <span class="n">lineprofile</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linemixing</span> <span class="o">=</span> <span class="n">linemixing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">threshold_intensity</span> <span class="o">=</span> <span class="n">threshold_intensity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit_intensity</span> <span class="o">=</span> <span class="n">fit_intensity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit_window</span> <span class="o">=</span> <span class="n">fit_window</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_window</span> <span class="o">=</span> <span class="n">sim_window</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_linelist_savename</span> <span class="o">=</span> <span class="n">base_linelist_savename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_linelist_savename</span> <span class="o">=</span> <span class="n">param_linelist_savename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nu_constrain</span> <span class="o">=</span> <span class="n">nu_constrain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sw_constrain</span> <span class="o">=</span> <span class="n">sw_constrain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma0_constrain</span> <span class="o">=</span> <span class="n">gamma0_constrain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delta0_constrain</span> <span class="o">=</span> <span class="n">delta0_constrain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aw_constrain</span> <span class="o">=</span> <span class="n">aw_constrain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">as_constrain</span> <span class="o">=</span> <span class="n">as_constrain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nuVC_constrain</span> <span class="o">=</span> <span class="n">nuVC_constrain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eta_constrain</span> <span class="o">=</span> <span class="n">eta_constrain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linemixing_constrain</span> <span class="o">=</span> <span class="n">linemixing_constrain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">additional_columns</span> <span class="o">=</span> <span class="n">additional_columns</span>
<div class="viewcode-block" id="Generate_FitParam_File.get_dataset"><a class="viewcode-back" href="../../MATS.html#MATS.generate_fitparam_file.Generate_FitParam_File.get_dataset">[docs]</a>    <span class="k">def</span> <span class="nf">get_dataset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span></div>
<div class="viewcode-block" id="Generate_FitParam_File.get_param_linelist"><a class="viewcode-back" href="../../MATS.html#MATS.generate_fitparam_file.Generate_FitParam_File.get_param_linelist">[docs]</a>    <span class="k">def</span> <span class="nf">get_param_linelist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_linelist</span></div>
<div class="viewcode-block" id="Generate_FitParam_File.get_base_linelist"><a class="viewcode-back" href="../../MATS.html#MATS.generate_fitparam_file.Generate_FitParam_File.get_base_linelist">[docs]</a>    <span class="k">def</span> <span class="nf">get_base_linelist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_linelist</span></div>
<div class="viewcode-block" id="Generate_FitParam_File.get_CIA_linelist"><a class="viewcode-back" href="../../MATS.html#MATS.generate_fitparam_file.Generate_FitParam_File.get_CIA_linelist">[docs]</a>    <span class="k">def</span> <span class="nf">get_CIA_linelist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">CIA_linelist</span></div>
<div class="viewcode-block" id="Generate_FitParam_File.generate_fit_param_linelist_from_linelist"><a class="viewcode-back" href="../../MATS.html#MATS.generate_fitparam_file.Generate_FitParam_File.generate_fit_param_linelist_from_linelist">[docs]</a>    <span class="k">def</span> <span class="nf">generate_fit_param_linelist_from_linelist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vary_nu</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">vary_sw</span> <span class="o">=</span> <span class="p">{},</span>
                                   <span class="n">vary_gamma0</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">vary_n_gamma0</span> <span class="o">=</span> <span class="p">{},</span>
                                   <span class="n">vary_delta0</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">vary_n_delta0</span> <span class="o">=</span> <span class="p">{},</span>
                                   <span class="n">vary_aw</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">vary_n_gamma2</span> <span class="o">=</span> <span class="p">{},</span>
                                   <span class="n">vary_as</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">vary_n_delta2</span> <span class="o">=</span> <span class="p">{},</span>
                                   <span class="n">vary_nuVC</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">vary_n_nuVC</span> <span class="o">=</span> <span class="p">{},</span>
                                   <span class="n">vary_eta</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">vary_linemixing</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">vary_n_linemixing</span> <span class="o">=</span> <span class="p">{}):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generates the parameter line list used in fitting and updates the fitting booleans to desired settings.</span>



<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        vary_nu : bool, optional</span>
<span class="sd">            Dictionary of dictionaries setting whether the molecule and isotope line centers should be floated.  Each key in the dictionary corresponds to a molecule, where the values are a dictionary corresponding to local_iso_ids as keys and boolean values acting as boolean flags. True means float the nu for that molecule and isotope. Example vary_nu = {7:{1:True, 2: False, 3: False}, 1:{1:False, 2: False, 3: False}}, would indicate that line centers of all main oxygen isotopes would be floated (if the line intensity is greater than the fit intensity), where the line centers for all other O2 isotopes and all water isotopes would not be varied. If these value are left blank, then all variable would have to be manually switched to float. The default is {}.</span>
<span class="sd">        vary_sw : bool, optional</span>
<span class="sd">            Dictionary of dictionaries setting whether the molecule and isotope line intensities should be floated.  Follows nu_vary example.  The default is {}.</span>
<span class="sd">        vary_gamma0 : bool, optional</span>
<span class="sd">            Dictionary of dictionaries setting whether the molecule and isotope collisional half-width should be floated.  Follows nu_vary example.  . The default is {}.</span>
<span class="sd">        vary_n_gamma0 : bool, optional</span>
<span class="sd">            Dictionary of dictionaries setting whether the molecule and isotope coefficient of the temperature dependence of the half width  should be floated.  Follows nu_vary example.  . The default is {}.</span>
<span class="sd">        vary_delta0 : bool, optional</span>
<span class="sd">            Dictionary of dictionaries setting whether the molecule and isotope pressure shift should be floated.  Follows nu_vary example.  . The default is {}.</span>
<span class="sd">        vary_n_delta0 : bool, optional</span>
<span class="sd">            Dictionary of dictionaries setting whether the molecule and isotope coefficient of the temperature dependence of the pressure shift should be floated.  Follows nu_vary example.  . The default is {}.</span>
<span class="sd">        vary_aw : bool, optional</span>
<span class="sd">            Dictionary of dictionaries setting whether the molecule and isotope ratio of the speed dependent width to the half-width should be floated.  Follows nu_vary example.  . The default is {}.</span>
<span class="sd">        vary_n_gamma2 : bool, optional</span>
<span class="sd">            Dictionary of dictionaries setting whether the molecule and isotope coefficient of the temperature dependence of the speed dependent width should be floated.  Follows nu_vary example.  . The default is {}.</span>
<span class="sd">        vary_as : bool, optional</span>
<span class="sd">            Dictionary of dictionaries setting whether the molecule and isotope the ratio of the speed dependent shift to the shift should be floated.  Follows nu_vary example.  . The default is {}.</span>
<span class="sd">        vary_n_delta2 : bool, optional</span>
<span class="sd">            Dictionary of dictionaries setting whether the molecule and isotope coefficient of the temperature dependence of the speed dependent shift should be floated.  Follows nu_vary example.  . The default is {}.</span>
<span class="sd">        vary_nuVC : bool, optional</span>
<span class="sd">            Dictionary of dictionaries setting whether the molecule and isotope dicke narrowing should be floated.  Follows nu_vary example.  . The default is {}.</span>
<span class="sd">        vary_n_nuVC : bool, optional</span>
<span class="sd">            Dictionary of dictionaries setting whether the molecule and isotope  coefficient of the temperature dependence of the dicke narrowing should be floated.  Follows nu_vary example.  . The default is {}.</span>
<span class="sd">        vary_eta : bool, optional</span>
<span class="sd">            Dictionary of dictionaries setting whether the molecule and isotope correlation parameter for the VC and SD effects should be floated.  Follows nu_vary example.  . The default is {}.</span>
<span class="sd">        vary_linemixing : bool, optional</span>
<span class="sd">            Dictionary of dictionaries setting whether the molecule and isotope first-order line-mixing should be floated.  Follows nu_vary example.  . The default is {}.</span>
<span class="sd">        vary_n_linemixing : bool, optional</span>
<span class="sd">            Dictionary of dictionaries setting whether the molecule and isotope temperature dependence for the first-order line-mixing should be floated.  Follows nu_vary example.  . The default is {}.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        param_linelist_df : dataframe</span>
<span class="sd">            returns dataframe based on parameter line list with addition of a vary and err column for every floatable parameter.  The vary columns are defined by the inputs and the fit_intensity value.  The err columns will be populated from fit results.  The dataframe is also saved as a .csv file.  line intensity will be normalized by the fit_intensity (set to the sw_scale_factor). The term &#39;sw&#39; is now equal to the normalized value, such that in the simulation &#39;sw&#39;*sw_scale_factor is used for the line intensity. Because line intensities are so small it is difficult to fit the value without normalization.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">param_linelist_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_param_linelist</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="c1">#Intensity Thresholding</span>
        <span class="n">param_linelist_df</span> <span class="o">=</span> <span class="n">param_linelist_df</span><span class="p">[</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold_intensity</span><span class="p">]</span> <span class="c1">#intensity thresholding</span>
        <span class="c1">#Cutdown linelist to parameters within specified simulation window of minimum and maximum of dataset</span>
        <span class="n">dataset_min</span><span class="p">,</span> <span class="n">dataset_max</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">get_spectra_extremes</span><span class="p">())</span>
        <span class="n">extreme_dictionary</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">get_spectrum_extremes</span><span class="p">()</span>
        <span class="n">param_linelist_df</span> <span class="o">=</span> <span class="n">param_linelist_df</span><span class="p">[</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">dataset_max</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_window</span><span class="p">)]</span>
        <span class="n">param_linelist_df</span> <span class="o">=</span> <span class="n">param_linelist_df</span><span class="p">[</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">dataset_min</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_window</span><span class="p">)]</span>
        <span class="c1">#delete parameters not partaining to species (where relevant)</span>
        <span class="n">diluent_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">spectrum</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">spectra</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">diluent</span> <span class="ow">in</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">Diluent</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">diluent</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">diluent_list</span><span class="p">:</span>
                    <span class="n">diluent_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diluent</span><span class="p">)</span>
        <span class="n">num_nominal_temps</span><span class="p">,</span> <span class="n">list_nominal_temps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">get_number_nominal_temperatures</span><span class="p">()</span>
        <span class="n">column_list</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">additional_columns</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">column_list</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;molec_id&#39;</span><span class="p">,</span> <span class="s1">&#39;local_iso_id&#39;</span><span class="p">,</span><span class="s1">&#39;elower&#39;</span><span class="p">,</span> <span class="s1">&#39;nu&#39;</span><span class="p">,</span> <span class="s1">&#39;sw&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">diluent</span> <span class="ow">in</span> <span class="n">diluent_list</span><span class="p">:</span>
            <span class="n">column_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;gamma0_&#39;</span> <span class="o">+</span> <span class="n">diluent</span><span class="p">)</span>
            <span class="n">column_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;n_gamma0_&#39;</span> <span class="o">+</span> <span class="n">diluent</span><span class="p">)</span>
            <span class="n">column_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;delta0_&#39;</span> <span class="o">+</span> <span class="n">diluent</span><span class="p">)</span>
            <span class="n">column_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;n_delta0_&#39;</span> <span class="o">+</span> <span class="n">diluent</span><span class="p">)</span>
            <span class="n">column_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;SD_gamma_&#39;</span> <span class="o">+</span> <span class="n">diluent</span><span class="p">)</span>
            <span class="n">column_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;n_gamma2_&#39;</span> <span class="o">+</span> <span class="n">diluent</span><span class="p">)</span>
            <span class="n">column_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;SD_delta_&#39;</span> <span class="o">+</span> <span class="n">diluent</span><span class="p">)</span>
            <span class="n">column_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;n_delta2_&#39;</span> <span class="o">+</span> <span class="n">diluent</span><span class="p">)</span>
            <span class="n">column_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;nuVC_&#39;</span> <span class="o">+</span> <span class="n">diluent</span><span class="p">)</span>
            <span class="n">column_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;n_nuVC_&#39;</span> <span class="o">+</span> <span class="n">diluent</span><span class="p">)</span>
            <span class="n">column_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;eta_&#39;</span> <span class="o">+</span> <span class="n">diluent</span><span class="p">)</span>
            <span class="n">column_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;y_&#39;</span> <span class="o">+</span> <span class="n">diluent</span><span class="p">)</span>
            <span class="n">column_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;n_y_&#39;</span> <span class="o">+</span> <span class="n">diluent</span><span class="p">)</span>

        <span class="n">param_linelist_df</span> <span class="o">=</span> <span class="n">param_linelist_df</span><span class="p">[</span><span class="n">column_list</span><span class="p">]</span>
        <span class="n">param_linelist_df</span> <span class="o">=</span> <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="c1">#Re-defines the Line intensity as sw*sw_scale_factor</span>
        <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_intensity</span>
        <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw_scale_factor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_intensity</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span>

        <span class="c1"># Defines the Linecenter parameters in the event that the line center is held constant across all samples and is not</span>
        <span class="c1">## Starting point is equal to the inital value</span>
        <span class="n">order_nu</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span>
        <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>
        <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu_err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nu_constrain</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">vary_nu</span> <span class="o">!=</span> <span class="p">{}:</span>
                <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">vary_nu</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">isotope</span> <span class="ow">in</span> <span class="n">vary_nu</span><span class="p">[</span><span class="n">molecule</span><span class="p">]:</span>
                        <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">dataset_min</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">dataset_max</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;molec_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">molecule</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;local_iso_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">isotope</span><span class="p">),</span> <span class="s1">&#39;nu_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vary_nu</span><span class="p">[</span><span class="n">molecule</span><span class="p">][</span><span class="n">isotope</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">get_list_spectrum_numbers</span><span class="p">():</span>
                <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)]</span> <span class="o">=</span> <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">order_nu</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;nu_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">))</span>
                <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>
                <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">vary_nu</span> <span class="o">!=</span> <span class="p">{}:</span>
                    <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">vary_nu</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">isotope</span> <span class="ow">in</span> <span class="n">vary_nu</span><span class="p">[</span><span class="n">molecule</span><span class="p">]:</span>
                            <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">dataset_min</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">dataset_max</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;molec_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">molecule</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;local_iso_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">isotope</span><span class="p">),</span> <span class="s1">&#39;nu_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vary_nu</span><span class="p">[</span><span class="n">molecule</span><span class="p">][</span><span class="n">isotope</span><span class="p">])</span>

        <span class="c1"># Defines the linestrength in the event that the sw is held constant across all samples and not</span>
        <span class="c1">## Starting point is equal to the initial value</span>
        <span class="n">order_sw</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">,</span> <span class="s1">&#39;sw_scale_factor&#39;</span><span class="p">]</span>
        <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>
        <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw_err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sw_constrain</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">vary_sw</span> <span class="o">!=</span> <span class="p">{}:</span>
                 <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">vary_sw</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">isotope</span> <span class="ow">in</span> <span class="n">vary_sw</span><span class="p">[</span><span class="n">molecule</span><span class="p">]:</span>
                        <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">dataset_min</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">dataset_max</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;molec_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">molecule</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;local_iso_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">isotope</span><span class="p">),</span> <span class="s1">&#39;sw_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vary_sw</span><span class="p">[</span><span class="n">molecule</span><span class="p">][</span><span class="n">isotope</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">get_list_spectrum_numbers</span><span class="p">():</span>
                <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)]</span> <span class="o">=</span> <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="n">order_sw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;sw_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">))</span>
                <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>
                <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">vary_sw</span> <span class="o">!=</span> <span class="p">{}:</span>
                    <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">vary_sw</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">isotope</span> <span class="ow">in</span> <span class="n">vary_sw</span><span class="p">[</span><span class="n">molecule</span><span class="p">]:</span>
                            <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">extreme_dictionary</span><span class="p">[</span><span class="n">spec</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">extreme_dictionary</span><span class="p">[</span><span class="n">spec</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;molec_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">molecule</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;local_iso_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">isotope</span><span class="p">),</span> <span class="s1">&#39;sw_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vary_sw</span><span class="p">[</span><span class="n">molecule</span><span class="p">][</span><span class="n">isotope</span><span class="p">])</span>

        <span class="c1">#Loop through other parameters and then set things to 0 based on lineshape</span>
        <span class="n">order_gamma0</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">order_delta0</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">order_SD_gamma</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">order_SD_delta</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">order_nuVC</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">order_eta</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">order_linemixing</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">diluent</span> <span class="ow">in</span> <span class="n">diluent_list</span><span class="p">:</span>
            <span class="c1">#Gamma0 option for constrain and not constrained</span>
            <span class="n">order_gamma0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;gamma0_&#39;</span> <span class="o">+</span> <span class="n">diluent</span><span class="p">)</span>
            <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;gamma0_&#39;</span> <span class="o">+</span> <span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>
            <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;gamma0_&#39;</span> <span class="o">+</span> <span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma0_constrain</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">vary_gamma0</span> <span class="o">!=</span> <span class="p">{}:</span>
                    <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">vary_gamma0</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">isotope</span> <span class="ow">in</span> <span class="n">vary_gamma0</span><span class="p">[</span><span class="n">molecule</span><span class="p">]:</span>
                            <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">dataset_min</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">dataset_max</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;molec_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">molecule</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;local_iso_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">isotope</span><span class="p">),</span> <span class="s1">&#39;gamma0_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vary_gamma0</span><span class="p">[</span><span class="n">molecule</span><span class="p">][</span><span class="n">isotope</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">get_list_spectrum_numbers</span><span class="p">():</span>
                    <span class="n">order_gamma0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;gamma0_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">))</span>
                    <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;gamma0_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;gamma0_&#39;</span> <span class="o">+</span> <span class="n">diluent</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
                    <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;gamma0_&#39;</span> <span class="o">+</span> <span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>
                    <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;gamma0_&#39;</span><span class="o">+</span> <span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">vary_gamma0</span> <span class="o">!=</span> <span class="p">{}:</span>
                        <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">vary_gamma0</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">isotope</span> <span class="ow">in</span> <span class="n">vary_gamma0</span><span class="p">[</span><span class="n">molecule</span><span class="p">]:</span>
                                <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">extreme_dictionary</span><span class="p">[</span><span class="n">spec</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">extreme_dictionary</span><span class="p">[</span><span class="n">spec</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;molec_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">molecule</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;local_iso_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">isotope</span><span class="p">),</span> <span class="s1">&#39;gamma0_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vary_gamma0</span><span class="p">[</span><span class="n">molecule</span><span class="p">][</span><span class="n">isotope</span><span class="p">])</span>
            <span class="n">order_gamma0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;n_gamma0_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="p">)</span>

            <span class="c1">#Delta0 option for constrain and not constrained</span>
            <span class="n">order_delta0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;delta0_&#39;</span> <span class="o">+</span> <span class="n">diluent</span><span class="p">)</span>
            <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;delta0_&#39;</span> <span class="o">+</span> <span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>
            <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;delta0_&#39;</span> <span class="o">+</span> <span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta0_constrain</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">vary_delta0</span> <span class="o">!=</span> <span class="p">{}:</span>
                    <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">vary_delta0</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">isotope</span> <span class="ow">in</span> <span class="n">vary_delta0</span><span class="p">[</span><span class="n">molecule</span><span class="p">]:</span>
                            <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">dataset_min</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">dataset_max</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;molec_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">molecule</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;local_iso_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">isotope</span><span class="p">),</span> <span class="s1">&#39;delta0_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vary_delta0</span><span class="p">[</span><span class="n">molecule</span><span class="p">][</span><span class="n">isotope</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">get_list_spectrum_numbers</span><span class="p">():</span>
                    <span class="n">order_delta0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;delta0_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">))</span>
                    <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;delta0_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;delta0_&#39;</span> <span class="o">+</span> <span class="n">diluent</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
                    <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;delta0_&#39;</span> <span class="o">+</span>  <span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;delta0_&#39;</span> <span class="o">+</span> <span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">vary_delta0</span> <span class="o">!=</span> <span class="p">{}:</span>
                        <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">vary_delta0</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">isotope</span> <span class="ow">in</span> <span class="n">vary_delta0</span><span class="p">[</span><span class="n">molecule</span><span class="p">]:</span>
                                <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">extreme_dictionary</span><span class="p">[</span><span class="n">spec</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">extreme_dictionary</span><span class="p">[</span><span class="n">spec</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;molec_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">molecule</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;local_iso_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">isotope</span><span class="p">),</span> <span class="s1">&#39;delta0_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vary_delta0</span><span class="p">[</span><span class="n">molecule</span><span class="p">][</span><span class="n">isotope</span><span class="p">])</span>
            <span class="n">order_delta0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;n_delta0_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="p">)</span>

            <span class="c1">#SD Gamma option for constrain and not constrained</span>
            <span class="n">order_SD_gamma</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;SD_gamma_&#39;</span> <span class="o">+</span> <span class="n">diluent</span> <span class="p">)</span>
            <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;SD_gamma_&#39;</span> <span class="o">+</span> <span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>
            <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;SD_gamma_&#39;</span> <span class="o">+</span> <span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">aw_constrain</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineprofile</span> <span class="o">==</span> <span class="s1">&#39;VP&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineprofile</span> <span class="o">==</span> <span class="s1">&#39;NGP&#39;</span><span class="p">):</span>
                    <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;SD_gamma_&#39;</span> <span class="o">+</span> <span class="n">diluent</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">vary_aw</span> <span class="o">!=</span> <span class="p">{}:</span>
                        <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">vary_aw</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">isotope</span> <span class="ow">in</span> <span class="n">vary_aw</span><span class="p">[</span><span class="n">molecule</span><span class="p">]:</span>
                                <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">dataset_min</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">dataset_max</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;molec_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">molecule</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;local_iso_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">isotope</span><span class="p">),</span> <span class="s1">&#39;SD_gamma_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vary_aw</span><span class="p">[</span><span class="n">molecule</span><span class="p">][</span><span class="n">isotope</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">get_list_spectrum_numbers</span><span class="p">():</span>
                    <span class="n">order_SD_gamma</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;SD_gamma_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">))</span>
                    <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;SD_gamma_&#39;</span> <span class="o">+</span> <span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>
                    <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;SD_gamma_&#39;</span> <span class="o">+</span> <span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineprofile</span> <span class="o">==</span> <span class="s1">&#39;VP&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineprofile</span> <span class="o">==</span> <span class="s1">&#39;NGP&#39;</span><span class="p">):</span>
                        <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;SD_gamma_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;SD_gamma_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;SD_gamma_&#39;</span> <span class="o">+</span> <span class="n">diluent</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">vary_aw</span> <span class="o">!=</span> <span class="p">{}:</span>
                            <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">vary_aw</span><span class="p">:</span>
                                <span class="k">for</span> <span class="n">isotope</span> <span class="ow">in</span> <span class="n">vary_aw</span><span class="p">[</span><span class="n">molecule</span><span class="p">]:</span>
                                    <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">extreme_dictionary</span><span class="p">[</span><span class="n">spec</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">extreme_dictionary</span><span class="p">[</span><span class="n">spec</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;molec_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">molecule</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;local_iso_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">isotope</span><span class="p">),</span> <span class="s1">&#39;SD_gamma_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vary_aw</span><span class="p">[</span><span class="n">molecule</span><span class="p">][</span><span class="n">isotope</span><span class="p">])</span>
            <span class="n">order_SD_gamma</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;n_gamma2_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="p">)</span>

            <span class="c1">#SD Delta option for constrain and not constrained</span>
            <span class="n">order_SD_delta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;SD_delta_&#39;</span> <span class="o">+</span> <span class="n">diluent</span><span class="p">)</span>
            <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;SD_delta_&#39;</span> <span class="o">+</span> <span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>
            <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;SD_delta_&#39;</span> <span class="o">+</span> <span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">as_constrain</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineprofile</span> <span class="o">==</span> <span class="s1">&#39;VP&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineprofile</span> <span class="o">==</span> <span class="s1">&#39;NGP&#39;</span><span class="p">):</span>
                    <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;SD_delta_&#39;</span> <span class="o">+</span> <span class="n">diluent</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">vary_as</span> <span class="o">!=</span> <span class="p">{}:</span>
                        <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">vary_as</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">isotope</span> <span class="ow">in</span> <span class="n">vary_as</span><span class="p">[</span><span class="n">molecule</span><span class="p">]:</span>
                                <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">dataset_min</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">dataset_max</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;molec_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">molecule</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;local_iso_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">isotope</span><span class="p">),</span> <span class="s1">&#39;SD_delta_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vary_as</span><span class="p">[</span><span class="n">molecule</span><span class="p">][</span><span class="n">isotope</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">get_list_spectrum_numbers</span><span class="p">():</span>
                    <span class="n">order_SD_delta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;SD_delta_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">))</span>
                    <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;SD_delta_&#39;</span> <span class="o">+</span> <span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>
                    <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;SD_delta_&#39;</span> <span class="o">+</span> <span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineprofile</span> <span class="o">==</span> <span class="s1">&#39;VP&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineprofile</span> <span class="o">==</span> <span class="s1">&#39;NGP&#39;</span><span class="p">):</span>
                        <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;SD_delta_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;SD_delta_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;SD_delta_&#39;</span> <span class="o">+</span> <span class="n">diluent</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

                        <span class="k">if</span> <span class="n">vary_as</span> <span class="o">!=</span> <span class="p">{}:</span>
                            <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">vary_as</span><span class="p">:</span>
                                <span class="k">for</span> <span class="n">isotope</span> <span class="ow">in</span> <span class="n">vary_as</span><span class="p">[</span><span class="n">molecule</span><span class="p">]:</span>
                                    <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">extreme_dictionary</span><span class="p">[</span><span class="n">spec</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">extreme_dictionary</span><span class="p">[</span><span class="n">spec</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;molec_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">molecule</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;local_iso_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">isotope</span><span class="p">),</span> <span class="s1">&#39;SD_delta_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vary_as</span><span class="p">[</span><span class="n">molecule</span><span class="p">][</span><span class="n">isotope</span><span class="p">])</span>
            <span class="n">order_SD_delta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;n_delta2_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="p">)</span>

            <span class="c1">#nuVC option for constrain and not constrained</span>
            <span class="n">order_nuVC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;nuVC_&#39;</span> <span class="o">+</span> <span class="n">diluent</span><span class="p">)</span>
            <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nuVC_&#39;</span> <span class="o">+</span> <span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>
            <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nuVC_&#39;</span> <span class="o">+</span> <span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nuVC_constrain</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineprofile</span> <span class="o">==</span> <span class="s1">&#39;VP&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineprofile</span> <span class="o">==</span> <span class="s1">&#39;SDVP&#39;</span><span class="p">):</span>
                    <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;nuVC_&#39;</span> <span class="o">+</span> <span class="n">diluent</span> <span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">vary_nuVC</span> <span class="o">!=</span> <span class="p">{}:</span>
                        <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">vary_nuVC</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">isotope</span> <span class="ow">in</span> <span class="n">vary_nuVC</span><span class="p">[</span><span class="n">molecule</span><span class="p">]:</span>
                                <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">dataset_min</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">dataset_max</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;molec_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">molecule</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;local_iso_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">isotope</span><span class="p">),</span> <span class="s1">&#39;nuVC_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vary_nuVC</span><span class="p">[</span><span class="n">molecule</span><span class="p">][</span><span class="n">isotope</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">get_list_spectrum_numbers</span><span class="p">():</span>
                    <span class="n">order_nuVC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;nuVC_&#39;</span> <span class="o">+</span> <span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">))</span>
                    <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nuVC_&#39;</span> <span class="o">+</span> <span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>
                    <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nuVC_&#39;</span> <span class="o">+</span> <span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineprofile</span> <span class="o">==</span> <span class="s1">&#39;VP&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineprofile</span> <span class="o">==</span> <span class="s1">&#39;SDVP&#39;</span><span class="p">):</span>
                        <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;nuVC_&#39;</span> <span class="o">+</span> <span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nuVC_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nuVC_&#39;</span> <span class="o">+</span> <span class="n">diluent</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

                        <span class="k">if</span> <span class="n">vary_nuVC</span> <span class="o">!=</span> <span class="p">{}:</span>
                            <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">vary_nuVC</span><span class="p">:</span>
                                <span class="k">for</span> <span class="n">isotope</span> <span class="ow">in</span> <span class="n">vary_nuVC</span><span class="p">[</span><span class="n">molecule</span><span class="p">]:</span>
                                    <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">extreme_dictionary</span><span class="p">[</span><span class="n">spec</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">extreme_dictionary</span><span class="p">[</span><span class="n">spec</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;molec_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">molecule</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;local_iso_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">isotope</span><span class="p">),</span> <span class="s1">&#39;nuVC_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vary_nuVC</span><span class="p">[</span><span class="n">molecule</span><span class="p">][</span><span class="n">isotope</span><span class="p">])</span>
            <span class="n">order_nuVC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;n_nuVC_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="p">)</span>

            <span class="c1">#eta option for constrain and not constrained</span>
            <span class="n">order_eta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;eta_&#39;</span> <span class="o">+</span> <span class="n">diluent</span><span class="p">)</span>
            <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;eta_&#39;</span> <span class="o">+</span> <span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>
            <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;eta_&#39;</span> <span class="o">+</span> <span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eta_constrain</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineprofile</span> <span class="o">==</span> <span class="s1">&#39;VP&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineprofile</span> <span class="o">==</span> <span class="s1">&#39;SDVP&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineprofile</span> <span class="o">==</span> <span class="s1">&#39;NGP&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineprofile</span> <span class="o">==</span> <span class="s1">&#39;SDNGP&#39;</span><span class="p">):</span>
                    <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;eta_&#39;</span> <span class="o">+</span> <span class="n">diluent</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">vary_eta</span> <span class="o">!=</span> <span class="p">{}:</span>
                        <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">vary_eta</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">isotope</span> <span class="ow">in</span> <span class="n">vary_eta</span><span class="p">[</span><span class="n">molecule</span><span class="p">]:</span>
                                <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">dataset_min</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">dataset_max</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;molec_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">molecule</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;local_iso_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">isotope</span><span class="p">),</span> <span class="s1">&#39;eta_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vary_eta</span><span class="p">[</span><span class="n">molecule</span><span class="p">][</span><span class="n">isotope</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">get_list_spectrum_numbers</span><span class="p">():</span>
                    <span class="n">order_eta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;eta_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">))</span>
                    <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;eta_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>
                    <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;eta_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineprofile</span> <span class="o">==</span> <span class="s1">&#39;VP&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineprofile</span> <span class="o">==</span> <span class="s1">&#39;SDVP&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineprofile</span> <span class="o">==</span> <span class="s1">&#39;NGP&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineprofile</span> <span class="o">==</span> <span class="s1">&#39;SDNGP&#39;</span><span class="p">):</span>
                        <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;eta_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;eta_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;eta_&#39;</span> <span class="o">+</span> <span class="n">diluent</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">vary_eta</span> <span class="o">!=</span> <span class="p">{}:</span>
                            <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">vary_eta</span><span class="p">:</span>
                                <span class="k">for</span> <span class="n">isotope</span> <span class="ow">in</span> <span class="n">vary_eta</span><span class="p">[</span><span class="n">molecule</span><span class="p">]:</span>
                                    <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">extreme_dictionary</span><span class="p">[</span><span class="n">spec</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">extreme_dictionary</span><span class="p">[</span><span class="n">spec</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;molec_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">molecule</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;local_iso_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">isotope</span><span class="p">),</span> <span class="s1">&#39;eta_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vary_eta</span><span class="p">[</span><span class="n">molecule</span><span class="p">][</span><span class="n">isotope</span><span class="p">])</span>

            <span class="c1"># Linemixing</span>
            <span class="n">order_linemixing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;y_&#39;</span> <span class="o">+</span> <span class="n">diluent</span><span class="p">)</span>
            <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;y_&#39;</span> <span class="o">+</span> <span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>
            <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;y_&#39;</span> <span class="o">+</span> <span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">linemixing</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">linemixing_constrain</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">vary_linemixing</span> <span class="o">!=</span> <span class="p">{}:</span>
                        <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">vary_linemixing</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">isotope</span> <span class="ow">in</span> <span class="n">vary_linemixing</span><span class="p">[</span><span class="n">molecule</span><span class="p">]:</span>
                                <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">dataset_min</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">dataset_max</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;molec_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">molecule</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;local_iso_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">isotope</span><span class="p">),</span> <span class="s1">&#39;y_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vary_linemixing</span><span class="p">[</span><span class="n">molecule</span><span class="p">][</span><span class="n">isotope</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">get_list_spectrum_numbers</span><span class="p">():</span>
                        <span class="n">order_linemixing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;y_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">))</span>
                        <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;y_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;y_&#39;</span> <span class="o">+</span> <span class="n">diluent</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
                        <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;y_&#39;</span> <span class="o">+</span> <span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>
                        <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;y_&#39;</span><span class="o">+</span> <span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">vary_linemixing</span> <span class="o">!=</span> <span class="p">{}:</span>
                            <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">vary_linemixing</span><span class="p">:</span>
                                <span class="k">for</span> <span class="n">isotope</span> <span class="ow">in</span> <span class="n">vary_linemixing</span><span class="p">[</span><span class="n">molecule</span><span class="p">]:</span>
                                    <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">extreme_dictionary</span><span class="p">[</span><span class="n">spec</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">extreme_dictionary</span><span class="p">[</span><span class="n">spec</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;molec_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">molecule</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;local_iso_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">isotope</span><span class="p">),</span> <span class="s1">&#39;y_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vary_linemixing</span><span class="p">[</span><span class="n">molecule</span><span class="p">][</span><span class="n">isotope</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;y_&#39;</span> <span class="o">+</span> <span class="n">diluent</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">order_linemixing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;n_y_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="p">)</span>
            
            <span class="c1">#Temperature Dependence</span>
            <span class="k">if</span> <span class="n">num_nominal_temps</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;n_gamma0_&#39;</span><span class="o">+</span><span class="n">diluent</span><span class="o">+</span><span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>
                <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;n_gamma0_&#39;</span><span class="o">+</span><span class="n">diluent</span><span class="o">+</span><span class="s1">&#39;_err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;n_delta0_&#39;</span><span class="o">+</span><span class="n">diluent</span><span class="o">+</span><span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>
                <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;n_delta0_&#39;</span><span class="o">+</span><span class="n">diluent</span><span class="o">+</span><span class="s1">&#39;_err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;n_gamma2_&#39;</span><span class="o">+</span><span class="n">diluent</span><span class="o">+</span><span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>
                <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;n_gamma2_&#39;</span><span class="o">+</span><span class="n">diluent</span><span class="o">+</span><span class="s1">&#39;_err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;n_delta2_&#39;</span><span class="o">+</span><span class="n">diluent</span><span class="o">+</span><span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>
                <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;n_delta2_&#39;</span><span class="o">+</span><span class="n">diluent</span><span class="o">+</span><span class="s1">&#39;_err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;n_nuVC_&#39;</span><span class="o">+</span><span class="n">diluent</span><span class="o">+</span><span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>
                <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;n_nuVC_&#39;</span><span class="o">+</span><span class="n">diluent</span><span class="o">+</span><span class="s1">&#39;_err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;n_y_&#39;</span><span class="o">+</span><span class="n">diluent</span><span class="o">+</span><span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>
                <span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;n_y_&#39;</span><span class="o">+</span><span class="n">diluent</span><span class="o">+</span><span class="s1">&#39;_err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="c1">#n_Gamma0</span>
                <span class="k">if</span> <span class="n">vary_n_gamma0</span> <span class="o">!=</span> <span class="p">{}:</span>
                    <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">vary_n_gamma0</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">isotope</span> <span class="ow">in</span> <span class="n">vary_n_gamma0</span><span class="p">[</span><span class="n">molecule</span><span class="p">]:</span>
                            <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">dataset_min</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">dataset_max</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;molec_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">molecule</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;local_iso_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">isotope</span><span class="p">),</span> <span class="s1">&#39;n_gamma0_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vary_n_gamma0</span><span class="p">[</span><span class="n">molecule</span><span class="p">][</span><span class="n">isotope</span><span class="p">])</span>
                <span class="c1">#n_Delta0</span>
                <span class="k">if</span> <span class="n">vary_n_delta0</span> <span class="o">!=</span> <span class="p">{}:</span>
                    <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">vary_n_delta0</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">isotope</span> <span class="ow">in</span> <span class="n">vary_n_delta0</span><span class="p">[</span><span class="n">molecule</span><span class="p">]:</span>
                            <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">dataset_min</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">dataset_max</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;molec_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">molecule</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;local_iso_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">isotope</span><span class="p">),</span> <span class="s1">&#39;n_delta0_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vary_n_delta0</span><span class="p">[</span><span class="n">molecule</span><span class="p">][</span><span class="n">isotope</span><span class="p">])</span>
                <span class="c1">#n_Gamma2</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineprofile</span> <span class="o">==</span> <span class="s1">&#39;VP&#39;</span><span class="p">)</span> <span class="ow">or</span>  <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineprofile</span> <span class="o">==</span> <span class="s1">&#39;NGP&#39;</span><span class="p">)</span> <span class="p">:</span>
                    <span class="k">if</span> <span class="n">vary_n_gamma2</span> <span class="o">!=</span> <span class="p">{}:</span>
                        <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">vary_n_gamma2</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">isotope</span> <span class="ow">in</span> <span class="n">vary_n_gamma2</span><span class="p">[</span><span class="n">molecule</span><span class="p">]:</span>
                                <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">dataset_min</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">dataset_max</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;molec_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">molecule</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;local_iso_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">isotope</span><span class="p">),</span> <span class="s1">&#39;n_gamma2_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vary_n_gamma2</span><span class="p">[</span><span class="n">molecule</span><span class="p">][</span><span class="n">isotope</span><span class="p">])</span>
                <span class="c1">#n_Delta2</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineprofile</span> <span class="o">==</span> <span class="s1">&#39;VP&#39;</span><span class="p">)</span> <span class="ow">or</span>  <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineprofile</span> <span class="o">==</span> <span class="s1">&#39;NGP&#39;</span><span class="p">)</span> <span class="p">:</span>
                    <span class="k">if</span> <span class="n">vary_n_delta2</span> <span class="o">!=</span> <span class="p">{}:</span>
                        <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">vary_n_delta2</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">isotope</span> <span class="ow">in</span> <span class="n">vary_n_delta2</span><span class="p">[</span><span class="n">molecule</span><span class="p">]:</span>
                                <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">dataset_min</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">dataset_max</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;molec_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">molecule</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;local_iso_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">isotope</span><span class="p">),</span> <span class="s1">&#39;n_delta2_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vary_n_delta2</span><span class="p">[</span><span class="n">molecule</span><span class="p">][</span><span class="n">isotope</span><span class="p">])</span>
                <span class="c1">#n_nuVC</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineprofile</span> <span class="o">==</span> <span class="s1">&#39;VP&#39;</span><span class="p">)</span> <span class="ow">or</span>  <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineprofile</span> <span class="o">==</span> <span class="s1">&#39;SDVP&#39;</span><span class="p">)</span> <span class="p">:</span>
                    <span class="k">if</span> <span class="n">vary_n_nuVC</span> <span class="o">!=</span> <span class="p">{}:</span>
                        <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">vary_n_nuVC</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">isotope</span> <span class="ow">in</span> <span class="n">vary_n_nuVC</span><span class="p">[</span><span class="n">molecule</span><span class="p">]:</span>
                                <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">dataset_min</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">dataset_max</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;molec_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">molecule</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;local_iso_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">isotope</span><span class="p">),</span> <span class="s1">&#39;n_nuVC_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vary_n_nuVC</span><span class="p">[</span><span class="n">molecule</span><span class="p">][</span><span class="n">isotope</span><span class="p">])</span>
                <span class="c1">#n_y</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linemixing</span><span class="p">)</span> <span class="p">:</span>
                    <span class="k">if</span> <span class="n">vary_n_linemixing</span> <span class="o">!=</span> <span class="p">{}:</span>
                        <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">vary_n_linemixing</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">isotope</span> <span class="ow">in</span> <span class="n">vary_n_linemixing</span><span class="p">[</span><span class="n">molecule</span><span class="p">]:</span>
                                <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">dataset_min</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">dataset_max</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;molec_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">molecule</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="s1">&#39;local_iso_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">isotope</span><span class="p">),</span> <span class="s1">&#39;n_y_&#39;</span> <span class="o">+</span><span class="n">diluent</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vary_n_linemixing</span><span class="p">[</span><span class="n">molecule</span><span class="p">][</span><span class="n">isotope</span><span class="p">])</span>
        
        <span class="n">ordered_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">additional_columns</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">ordered_list</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;molec_id&#39;</span><span class="p">,</span> <span class="s1">&#39;local_iso_id&#39;</span><span class="p">,</span><span class="s1">&#39;elower&#39;</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">order_nu</span><span class="p">:</span>
            <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">)</span>
            <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">order_sw</span><span class="p">:</span>
            <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">item</span> <span class="o">!=</span> <span class="s1">&#39;sw_scale_factor&#39;</span><span class="p">:</span>
                <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">)</span>
                <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">order_gamma0</span><span class="p">:</span>
            <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">num_nominal_temps</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">)</span>
                <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;n_&#39;</span> <span class="o">!=</span> <span class="n">item</span><span class="p">[:</span><span class="mi">2</span><span class="p">]:</span>
                    <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">)</span>
                    <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">order_delta0</span><span class="p">:</span>
            <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">num_nominal_temps</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">)</span>
                <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;n_&#39;</span> <span class="o">!=</span> <span class="n">item</span><span class="p">[:</span><span class="mi">2</span><span class="p">]:</span>
                    <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">)</span>
                    <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">order_nuVC</span><span class="p">:</span>
            <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">num_nominal_temps</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">)</span>
                <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;n_&#39;</span> <span class="o">!=</span> <span class="n">item</span><span class="p">[:</span><span class="mi">2</span><span class="p">]:</span>
                    <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">)</span>
                    <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">order_SD_gamma</span><span class="p">:</span>
            <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">num_nominal_temps</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">)</span>
                <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;n_&#39;</span> <span class="o">!=</span> <span class="n">item</span><span class="p">[:</span><span class="mi">2</span><span class="p">]:</span>
                    <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">)</span>
                    <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">order_SD_delta</span><span class="p">:</span>
            <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">num_nominal_temps</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">)</span>
                <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;n_&#39;</span> <span class="o">!=</span> <span class="n">item</span><span class="p">[:</span><span class="mi">2</span><span class="p">]:</span>
                    <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">)</span>
                    <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">order_eta</span><span class="p">:</span>
            <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">)</span>
            <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">order_linemixing</span><span class="p">:</span>          
            <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">num_nominal_temps</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">)</span>
                <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;n_&#39;</span> <span class="o">!=</span> <span class="n">item</span><span class="p">[:</span><span class="mi">2</span><span class="p">]:</span>
                    <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">)</span>
                    <span class="n">ordered_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">)</span>
        <span class="n">param_linelist_df</span> <span class="o">=</span> <span class="n">param_linelist_df</span><span class="p">[</span><span class="n">ordered_list</span><span class="p">]</span>
        <span class="n">param_linelist_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_linelist_savename</span> <span class="o">+</span> <span class="s1">&#39;.csv&#39;</span><span class="p">)</span> <span class="c1">#</span>

        <span class="c1">#Warnings of SD_gamma, SD_delta, nuVC, eta are zero and floated</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">ordered_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;SD_gamma&#39;</span> <span class="ow">in</span> <span class="n">param</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="s1">&#39;vary&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">param</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="s1">&#39;err&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">param</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="n">param</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="n">param</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">)])</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="s1">&#39;: floating SD_gamma terms when the initial guess is zero can make it difficult for the solution to converge. Consider setting initial guess to a non-zero value.&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;SD_delta&#39;</span> <span class="ow">in</span> <span class="n">param</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="s1">&#39;vary&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">param</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="s1">&#39;err&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">param</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="n">param</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="n">param</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">)])</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="s1">&#39;: floating SD_delta terms when the initial guess is zero can make it difficult for the solution to converge. Consider setting initial guess to a non-zero value.&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;nuVC&#39;</span> <span class="ow">in</span> <span class="n">param</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="s1">&#39;vary&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">param</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="s1">&#39;err&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">param</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="s1">&#39;n_nuVC&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">param</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="n">param</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">param_linelist_df</span><span class="p">[</span><span class="n">param</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">)])</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="s1">&#39;: floating nuVC terms when the initial guess is zero can make it difficult for the solution to converge. Consider setting initial guess to a non-zero value.  This is generally less of an issue than the case where SD_gamma is floated when the initial guess is zero.&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">param_linelist_df</span></div>

<div class="viewcode-block" id="Generate_FitParam_File.generate_fit_baseline_linelist"><a class="viewcode-back" href="../../MATS.html#MATS.generate_fitparam_file.Generate_FitParam_File.generate_fit_baseline_linelist">[docs]</a>    <span class="k">def</span> <span class="nf">generate_fit_baseline_linelist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vary_baseline</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">vary_pressure</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">vary_temperature</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span><span class="n">vary_molefraction</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">vary_xshift</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                                      <span class="n">vary_etalon_amp</span><span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">vary_etalon_period</span><span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">vary_etalon_phase</span><span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                                      <span class="n">vary_ILS_res</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generates the baseline line list used in fitting and updates the fitting booleans to desired settings.</span>


<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        vary_baseline : bool, optional</span>
<span class="sd">            If True, then sets all baseline parameters for all spectra to float. The default is True.</span>
<span class="sd">        vary_pressure : bool, optional</span>
<span class="sd">            If True, then the pressures for all spectra are floated.  This should be used with caution as the impact these parameters have on other floated parameters might lead to an unstable solution. The default is False.</span>
<span class="sd">        vary_temperature : bool, optional</span>
<span class="sd">            If True, then the temperatures for all spectra are floated. This should be used with caution as the impact these parameters have on other floated parameters might lead to an unstable solution.The default is False.</span>
<span class="sd">        vary_molefraction : dict, optional</span>
<span class="sd">            keys to dictionary correspond to molecule id where the value is boolean flag, which dictates whether to float the mole fraction. The default is {}. Example: {7: True, 1: False}</span>
<span class="sd">        vary_xshift : bool, optional</span>
<span class="sd">            If True, then sets x-shift parameters for all spectra to float. The default is False.</span>
<span class="sd">        vary_etalon_amp : bool, optional</span>
<span class="sd">            If True, then sets etalon amplitude parameters for all spectra to float. The default is False.</span>
<span class="sd">        vary_etalon_period : bool, optional</span>
<span class="sd">            If True, then sets etalon period parameters for all spectra to float. . The default is False.</span>
<span class="sd">        vary_etalon_phase : bool, optional</span>
<span class="sd">            If True, then sets etalon phase parameters for all spectra to float.. The default is False.</span>
<span class="sd">        vary_ILS_res : bool, optional</span>
<span class="sd">            If True, then sets ILS resolution parameters for all spectra to float.. The default is False.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        base_linelist_df : dataframe</span>
<span class="sd">            returns dataframe based on baseline line list with addition of a vary and err column for every floatable parameter.  The vary columns are defined by the inputs.  The err columns will be populated from fit results.  The dataframe is also saved as a .csv file..</span>



<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">base_linelist_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_base_linelist</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">parameters</span> <span class="o">=</span>  <span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">base_linelist_df</span><span class="p">))</span>
        <span class="n">baseline_param_order</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Segment Number&#39;</span><span class="p">]</span>

        <span class="c1">#Generate Fit Baseline file</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;Baseline Order&#39;</span> <span class="o">!=</span> <span class="n">param</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;Segment Number&#39;</span> <span class="o">!=</span> <span class="n">param</span><span class="p">):</span>
                <span class="n">base_linelist_df</span><span class="p">[</span><span class="n">param</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">base_linelist_df</span><span class="p">[</span><span class="n">param</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span><span class="o">=</span> <span class="kc">False</span>
                <span class="n">baseline_param_order</span> <span class="o">+=</span> <span class="p">[</span><span class="n">param</span><span class="p">,</span> <span class="n">param</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">,</span> <span class="n">param</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span>

            <span class="k">if</span> <span class="s1">&#39;Pressure&#39;</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
                <span class="n">base_linelist_df</span><span class="p">[</span><span class="n">param</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">base_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[(</span><span class="n">vary_pressure</span><span class="p">)]</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">vary_pressure</span><span class="p">):</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;USE CAUTION WHEN FLOATING PRESSURES&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;Temperature&#39;</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
                <span class="n">base_linelist_df</span><span class="p">[</span><span class="n">param</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">base_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[(</span><span class="n">vary_temperature</span><span class="p">)]</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">vary_temperature</span><span class="p">):</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;USE CAUTION WHEN FLOATING TEMPERATURES&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;x_shift&#39;</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
                <span class="n">base_linelist_df</span><span class="p">[</span><span class="n">param</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">base_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[(</span><span class="n">vary_xshift</span><span class="p">)]</span>
            <span class="k">if</span> <span class="s1">&#39;baseline&#39;</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
                <span class="n">order</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;baseline_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span> <span class="o">-</span> <span class="mi">97</span>
                <span class="n">base_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">base_linelist_df</span><span class="p">[</span><span class="s1">&#39;Baseline Order&#39;</span><span class="p">]</span><span class="o">&gt;=</span> <span class="n">order</span><span class="p">,</span> <span class="n">param</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vary_baseline</span>
            <span class="k">if</span> <span class="s1">&#39;molefraction&#39;</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">molecule</span> <span class="ow">in</span> <span class="n">vary_molefraction</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">isotope_list</span><span class="p">[(</span><span class="n">molecule</span><span class="p">,</span> <span class="mi">1</span><span class="p">)][</span><span class="mi">4</span><span class="p">])</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
                        <span class="n">base_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">base_linelist_df</span><span class="p">[</span><span class="n">param</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">,</span> <span class="n">param</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vary_molefraction</span><span class="p">[</span><span class="n">molecule</span><span class="p">])</span>
            <span class="k">if</span> <span class="s1">&#39;amp&#39;</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
                <span class="n">base_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">base_linelist_df</span><span class="p">[</span><span class="n">param</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">,</span> <span class="n">param</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vary_etalon_amp</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;period&#39;</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
                <span class="n">base_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">base_linelist_df</span><span class="p">[</span><span class="n">param</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">,</span> <span class="n">param</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vary_etalon_period</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;phase&#39;</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
                <span class="n">base_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">base_linelist_df</span><span class="p">[</span><span class="n">param</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;phase&quot;</span><span class="p">,</span> <span class="s2">&quot;period&quot;</span><span class="p">)]</span><span class="o">!=</span><span class="mi">0</span><span class="p">,</span> <span class="n">param</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vary_etalon_phase</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;_res_&#39;</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
                <span class="n">base_linelist_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">base_linelist_df</span><span class="p">[</span><span class="n">param</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">,</span> <span class="n">param</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vary_ILS_res</span><span class="p">)</span>


        <span class="c1">#base_linelist_df.drop([&#39;Baseline Order&#39;], axis=1, inplace = True)</span>
        <span class="n">base_linelist_df</span> <span class="o">=</span> <span class="n">base_linelist_df</span><span class="p">[</span><span class="n">baseline_param_order</span><span class="p">]</span>
        <span class="c1">#base_linelist_df = base_linelist_df.reindex(sorted(base_linelist_df.columns), axis=1)</span>
        <span class="n">base_linelist_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_linelist_savename</span> <span class="o">+</span> <span class="s1">&#39;.csv&#39;</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">base_linelist_df</span></div>
    
<div class="viewcode-block" id="Generate_FitParam_File.generate_fit_KarmanCIA_linelist"><a class="viewcode-back" href="../../MATS.html#MATS.generate_fitparam_file.Generate_FitParam_File.generate_fit_KarmanCIA_linelist">[docs]</a>    <span class="k">def</span> <span class="nf">generate_fit_KarmanCIA_linelist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vary_S_SO</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">vary_S_EXCH</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> 
                                        <span class="n">vary_EXCH_temp</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">vary_SO_temp</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> 
                                        <span class="n">vary_EXCH_shift</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">vary_SO_shift</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="n">CIA_linelist_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_CIA_linelist</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">parameters</span> <span class="o">=</span>  <span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">CIA_linelist_df</span><span class="p">))</span>
         <span class="c1">#Initial Calculation of the Karman CIA based on initial guesses and application to spectra</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">CIA_model</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Karman&#39;</span><span class="p">:</span>
            <span class="c1">#CIA_pairs = CIA_linelist_df[&#39;CIA Pair&#39;].unique()</span>
            <span class="k">for</span> <span class="n">spectrum</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">spectra</span><span class="p">:</span>
             
                <span class="n">CIA</span> <span class="o">=</span> <span class="n">o2_cia_karman_model</span><span class="p">(</span><span class="n">spectrum</span><span class="o">.</span><span class="n">wavenumber</span><span class="p">,</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">get_temperature</span><span class="p">(),</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">get_pressure</span><span class="p">(),</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">get_Diluent</span><span class="p">(),</span>
                        <span class="n">CIA_linelist_df</span><span class="p">[</span><span class="n">CIA_linelist_df</span><span class="p">[</span><span class="s1">&#39;CIA Pair&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;O2_O2&#39;</span><span class="p">][</span><span class="s1">&#39;S_SO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                        <span class="n">CIA_linelist_df</span><span class="p">[</span><span class="n">CIA_linelist_df</span><span class="p">[</span><span class="s1">&#39;CIA Pair&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;O2_N2&#39;</span><span class="p">][</span><span class="s1">&#39;S_SO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                        <span class="n">CIA_linelist_df</span><span class="p">[</span><span class="n">CIA_linelist_df</span><span class="p">[</span><span class="s1">&#39;CIA Pair&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;O2_O2&#39;</span><span class="p">][</span><span class="s1">&#39;S_EXCH&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                        <span class="n">CIA_linelist_df</span><span class="p">[</span><span class="n">CIA_linelist_df</span><span class="p">[</span><span class="s1">&#39;CIA Pair&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;O2_O2&#39;</span><span class="p">][</span><span class="s1">&#39;EXCH_b&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                        <span class="n">CIA_linelist_df</span><span class="p">[</span><span class="n">CIA_linelist_df</span><span class="p">[</span><span class="s1">&#39;CIA Pair&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;O2_O2&#39;</span><span class="p">][</span><span class="s1">&#39;EXCH_c&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                        <span class="n">CIA_linelist_df</span><span class="p">[</span><span class="n">CIA_linelist_df</span><span class="p">[</span><span class="s1">&#39;CIA Pair&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;O2_O2&#39;</span><span class="p">][</span><span class="s1">&#39;SO_b&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                        <span class="n">CIA_linelist_df</span><span class="p">[</span><span class="n">CIA_linelist_df</span><span class="p">[</span><span class="s1">&#39;CIA Pair&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;O2_O2&#39;</span><span class="p">][</span><span class="s1">&#39;SO_c&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                        <span class="n">CIA_linelist_df</span><span class="p">[</span><span class="n">CIA_linelist_df</span><span class="p">[</span><span class="s1">&#39;CIA Pair&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;O2_N2&#39;</span><span class="p">][</span><span class="s1">&#39;SO_b&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                        <span class="n">CIA_linelist_df</span><span class="p">[</span><span class="n">CIA_linelist_df</span><span class="p">[</span><span class="s1">&#39;CIA Pair&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;O2_N2&#39;</span><span class="p">][</span><span class="s1">&#39;SO_c&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                        <span class="n">SO_shift_O2_O2</span> <span class="o">=</span> <span class="n">CIA_linelist_df</span><span class="p">[</span><span class="n">CIA_linelist_df</span><span class="p">[</span><span class="s1">&#39;CIA Pair&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;O2_O2&#39;</span><span class="p">][</span><span class="s1">&#39;SO_shift&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                        <span class="n">SO_shift_O2_N2</span> <span class="o">=</span> <span class="n">CIA_linelist_df</span><span class="p">[</span><span class="n">CIA_linelist_df</span><span class="p">[</span><span class="s1">&#39;CIA Pair&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;O2_N2&#39;</span><span class="p">][</span><span class="s1">&#39;SO_shift&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                        <span class="n">EXCH_shift</span> <span class="o">=</span> <span class="n">CIA_linelist_df</span><span class="p">[</span><span class="n">CIA_linelist_df</span><span class="p">[</span><span class="s1">&#39;CIA Pair&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;O2_O2&#39;</span><span class="p">][</span><span class="s1">&#39;EXCH_shift&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">band</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">CIA_model</span><span class="p">[</span><span class="s1">&#39;band&#39;</span><span class="p">])</span>
                <span class="n">spectrum</span><span class="o">.</span><span class="n">set_cia</span><span class="p">(</span><span class="n">CIA</span><span class="p">)</span>
            <span class="c1"># Set parameter floats</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;CIA Pair&#39;</span> <span class="o">!=</span> <span class="n">param</span><span class="p">):</span>
                    <span class="n">CIA_linelist_df</span><span class="p">[</span><span class="n">param</span> <span class="o">+</span> <span class="s1">&#39;_err&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">CIA_linelist_df</span><span class="p">[</span><span class="n">param</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span><span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="s1">&#39;S_SO&#39;</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
                    <span class="n">CIA_linelist_df</span><span class="p">[</span><span class="n">param</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span><span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">CIA_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[(</span><span class="n">vary_S_SO</span><span class="p">)]</span>
                <span class="k">if</span> <span class="s1">&#39;S_EXCH&#39;</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
                    <span class="n">CIA_linelist_df</span><span class="p">[</span><span class="n">param</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span><span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">CIA_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[(</span><span class="n">vary_S_EXCH</span><span class="p">)]</span>
                <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;EXCH_b&#39;</span> <span class="ow">in</span> <span class="n">param</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="s1">&#39;EXCH_c&#39;</span> <span class="ow">in</span> <span class="n">param</span><span class="p">):</span>
                    <span class="n">CIA_linelist_df</span><span class="p">[</span><span class="n">param</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">CIA_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[(</span><span class="n">vary_EXCH_temp</span><span class="p">)]</span>
                <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;SO_b&#39;</span> <span class="ow">in</span> <span class="n">param</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="s1">&#39;SO_c&#39;</span> <span class="ow">in</span> <span class="n">param</span><span class="p">):</span>
                    <span class="n">CIA_linelist_df</span><span class="p">[</span><span class="n">param</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">CIA_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[(</span><span class="n">vary_SO_temp</span><span class="p">)]</span>
                <span class="k">if</span> <span class="s1">&#39;SO_shift&#39;</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
                    <span class="n">CIA_linelist_df</span><span class="p">[</span><span class="n">param</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span><span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">CIA_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[(</span><span class="n">vary_SO_shift</span><span class="p">)]</span>                 
                <span class="k">if</span> <span class="s1">&#39;EXCH_shift&#39;</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
                    <span class="n">CIA_linelist_df</span><span class="p">[</span><span class="n">param</span> <span class="o">+</span> <span class="s1">&#39;_vary&#39;</span><span class="p">]</span><span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">CIA_linelist_df</span><span class="p">)</span><span class="o">*</span><span class="p">[(</span><span class="n">vary_EXCH_shift</span><span class="p">)]</span> 
            <span class="n">CIA_linelist_df</span> <span class="o">=</span> <span class="n">CIA_linelist_df</span><span class="p">[[</span><span class="s1">&#39;CIA Pair&#39;</span><span class="p">,</span> 
                                               <span class="s1">&#39;S_SO&#39;</span><span class="p">,</span> <span class="s1">&#39;S_SO_err&#39;</span><span class="p">,</span> <span class="s1">&#39;S_SO_vary&#39;</span><span class="p">,</span> 
                                               <span class="s1">&#39;S_EXCH&#39;</span><span class="p">,</span> <span class="s1">&#39;S_EXCH_err&#39;</span><span class="p">,</span> <span class="s1">&#39;S_EXCH_vary&#39;</span><span class="p">,</span>
                                               <span class="s1">&#39;EXCH_b&#39;</span><span class="p">,</span> <span class="s1">&#39;EXCH_b_err&#39;</span><span class="p">,</span> <span class="s1">&#39;EXCH_b_vary&#39;</span><span class="p">,</span> 
                                               <span class="s1">&#39;EXCH_c&#39;</span><span class="p">,</span> <span class="s1">&#39;EXCH_c_err&#39;</span><span class="p">,</span> <span class="s1">&#39;EXCH_c_vary&#39;</span><span class="p">,</span> 
                                               <span class="s1">&#39;SO_b&#39;</span><span class="p">,</span> <span class="s1">&#39;SO_b_err&#39;</span><span class="p">,</span> <span class="s1">&#39;SO_b_vary&#39;</span><span class="p">,</span> 
                                               <span class="s1">&#39;SO_c&#39;</span><span class="p">,</span> <span class="s1">&#39;SO_c_err&#39;</span><span class="p">,</span> <span class="s1">&#39;SO_c_vary&#39;</span><span class="p">,</span> 
                                               <span class="s1">&#39;SO_shift&#39;</span><span class="p">,</span> <span class="s1">&#39;SO_shift_err&#39;</span><span class="p">,</span> <span class="s1">&#39;SO_shift_vary&#39;</span><span class="p">,</span> 
                                               <span class="s1">&#39;EXCH_shift&#39;</span><span class="p">,</span> <span class="s1">&#39;EXCH_shift_err&#39;</span><span class="p">,</span> <span class="s1">&#39;EXCH_shift_vary&#39;</span><span class="p">]]</span>
            <span class="n">CIA_linelist_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CIA_linelist_savename</span> <span class="o">+</span> <span class="s1">&#39;.csv&#39;</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">CIA_linelist_df</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;generate_fit_KarmanCIA_linelist only applies to the CIA files generated for the Karman CIA model&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span></div></div>

</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">MATS 3 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">MATS.generate_fitparam_file</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>